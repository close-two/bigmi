!function(e){function t(a){if(i[a])return i[a].exports;var s=i[a]={exports:{},id:a,loaded:!1};return e[a].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){e.exports=i(1)},function(e,t,i){i(2),window.marked=i(3),i(4),i(5),i(6),i(8),i(10),i(11);var a=i(12),s=i(13),o=i(14),n=i(15),r=i(16),d=i(17),l=i(20),c=i(23);$.productBuy=function(e){var t={pid:e.id,seckillSale:!1,product:"",parts:[],install:[],stockData:[],presalesData:[],hdinfoData:[],hdinfoBookingData:[],hdinfoPresalesData:[],orderData:{},bigtapDataId:[],bigtapDataType:[],stockDataId:[],orderDataId:[],presalesDataId:[],chooseResult:{},selectedAddr:[],services:{},mitvMember:null,allGoods:[],sortData:[],coupon:!1,saltTitle:"",address:!1,defaultOnce:!0,isAllBooking:!0,goodsStock:0,mihomeId:"",selectStockInit:!1,selected:[],btnTxt:{bigtap:"加入购物车",presales:"加入购物车",booking:"立即预订",subscribe:"立即预约",reserve:"立即预约"},bigTagJson:{bigtap:{0:"hdinfoData",1:"stockData"},presales:{0:"hdinfoPresalesData",1:"presalesData"},booking:{0:"hdinfoBookingData",1:"presalesData"}}},p={config:$.extend(s,e),selectService:function(){var e=this,i=$(".J_service").find("li");i.on("click",function(){var i=$(this).data("id"),a=$(this).parents(".J_service"),s=a.find("li"),o=a.data("index"),n=a.data("multi");$(this).hasClass("active")?($(this).removeClass("active"),delete t.services[o][i],$.isEmptyObject(t.services[o])&&delete t.services[o]):(n?t.services.hasOwnProperty(o)||(t.services[o]={}):(s.removeClass("active"),t.services[o]={}),$(this).addClass("active"),t.services[o][i]={id:i,bargain_id:$(this).data("bargain_id"),name:$(this).data("name"),oriprice:$(this).data("oriprice"),price:$(this).data("price"),source:$(this).data("source")}),e.formateProList()}),i.find(".agreement a").on("click",function(e){e.stopPropagation()})},formateProList:function(){if(t.parts.length||t.install.length||!$.isEmptyObject(t.services)||""!==t.product){var e=i(26);$("#J_proList").removeClass("hide").html(e(t))}else $("#J_proList").addClass("hide")},selectList:function(e,i){var a=this,s=e.find("li"),o=s.find("a"),n=e.find(".J_listDescBox"),r=e.find(".J_listTips"),d=n.find(".J_listNum"),l={},c={},p={},h=function(){var e="",t=0,i=0;for(var a in l)(""!==l[a]||0===l[a])&&(e+=l[a]+"、",t+=parseFloat(c[a]),i+=parseFloat(p[a]));e=e.substring(0,e.length-1),n.find(".desc").html(e).end().find(".price").addClass(i===t?"":"del").html((i===t?"":"<del>"+i+"元</del>")+t+"元 ")},u=function(e,t){e.find(".img").attr("src",t.data("img")).end().find(".name").html(t.data("name")).end().find(".price").find("em").html(t.data("price")),e.find(".price").find("del").html(parseFloat(t.data("price"))<parseFloat(t.data("originalprice"))?t.data("originalprice"):"")},g=function(e){1===e?(n.addClass("hide"),r.removeClass("hide")):(n.removeClass("hide"),r.addClass("hide"))},f=function(e,t){var i=[],a=$(t).data("id"),s=$(t).parents("li").index();return $.each(e,function(e,t){t.id!==a&&t.index!==s&&i.push(t)}),i},m=function(e,a){l[e]=a.data("name"),c[e]=a.data("price"),p[e]=a.data("originalprice"),t[i].push({index:a.parents("li").index(),item:a.index(),id:a.data("id"),is_bargain:a.data("is_bargain")||!1,bargain_id:a.data("bargain_id")||"",name:l[e],price:c[e]})};o.on("click",function(){if(!$(this).hasClass("active")){var e=$(this).parents("li");$(this).addClass("active").siblings("a").removeClass("active"),u(e,$(this)),e.hasClass("active")&&(t[i]=f(t[i],e.find(".active")),m(e.index(),$(this)),a.formateProList(),h())}});var v=s.find("i");v.on("click",function(){var e=$(this).parents("li"),s=e.index();e.hasClass("active")?(e.removeClass("active"),l[s]="",c[s]=0,p[s]=0,t[i]=f(t[i],e.find(".active")),u(e,e.find("a").eq(0)),e.siblings("li").hasClass("active")?d.html(parseFloat(d.html())-1):(d.html("0"),g(1))):(e.addClass("active"),d.html(parseFloat(d.html())+1),g(),m(s,e.find(".active"))),h(),a.formateProList()});var _=e.find(".J_extend"),b=e.find("ul");_.on("click",function(){b.toggleClass("hide"),_.hasClass("active")?(_.removeClass("active").html("&#xe61b;"),0===parseFloat(d.html())&&(n.addClass("hide"),r.removeClass("hide"))):(_.addClass("active").html("&#xe612;"),0===parseFloat(d.html())?(n.addClass("hide"),r.removeClass("hide")):(n.removeClass("hide"),r.addClass("hide")))}),e.find(".J_listDelete").on("click",function(){g(1);for(var e=0,o=s.length;o>e;e++)s.eq(e).removeClass("active").find("i").removeClass("active");t[i]=[],l={},d.html(0),a.formateProList()})},formateNum:function(e,t){return(10>e?"0"+e:e)+(t?t:"")},buyCountDown:function(e){var t=this;clearInterval(t.msTimer);var i=Math.floor(e%60),a=Math.floor(e/60%60),s=10;t.msTimer=setInterval(function(){s-=1,$(".J_timer").find("span").html(t.formateNum(a)+":"+t.formateNum(i)+"  "+s)},100)},countDown:function(){if(!("booking"!==t.type||t.hdstarttime&&t.hdendtime))return void this.setBookingTimeup();var e=this;$.miCountdown({startTime:t.hdstarttime,endTime:t.hdendtime,onTime:function(i){i>3600||(0===$(".countdown").find(".J_timer").length&&$(".countdown").html('<a href="javascript:void(0);" class="btn btn-primary btn-biglarge J_timer" data-type="'+t.type+'" data-name="'+$(".countdown").data("name")+'">距开售仅剩 <span ></span></a>'),window.now=i,e.buyCountDown(i))},onStart:function(){e.changeBuy()},onEnd:function(){e.changeBuy("end")}})},changeBuy:function(e){$(".J_timer").removeClass("J_timer"),clearInterval(this.msTimer),"end"===e?this.setBtn():this.setBtn(this.config.isLogin?1:-1)},setBookingTimeup:function(){$(".J_bookTime").html("预售已结束"),this.setBtn()},getTime:function(){var e=this,i=0,a=0;"booking"===t.type?(i=t.bookStarttime,a=t.bookEndtime):("subscribe"===t.type||"reserve"===t.type)&&(i=parseInt((new Date).getTime()/1e3),a=t.subscribe.subscribe_end_time,l({_config:t}).getCount()),$.miCountdown({startTime:i,endTime:a,upTime:!0,onStart:function(t){e.countTime(t)},onEnd:function(){"booking"===t.type&&e.setBookingTimeup(),("subscribe"===t.type||"reserve"===t.type)&&($(".J_orderTime").html("预约已结束"),$(".J_proBuyBtn").addClass("btn-disabled").removeClass("J_proBuyBtn").html(t.subscribe.end_button_title))}})},countTime:function(e,i){var a=this.formateNum(Math.floor(e%60)),s=this.formateNum(Math.floor(e/60%60)),o=this.formateNum(Math.floor(e/3600%24)),n=Math.floor(e/86400)>0?Math.floor(e/86400):"";n=n>0?n+" 天 ":"";var r=("seckillBefore"==i?"距开始 ":"剩 ")+n+o+" 时 "+s+" 分 "+a+" 秒";return!i||"seckill"!=i&&"seckillBefore"!=i?("booking"===t.type&&$(".J_bookTime").html(r),void(("subscribe"===t.type||"reserve"===t.type)&&$(".J_orderTime").html(r))):void $(".J_seckillTime").html(r)},formatBookTime:function(e){var t=new Date(1e3*parseInt(e)),i=t.getFullYear()+"年",a=this.formateNum(t.getMonth()+1,"月"),s=this.formateNum(t.getDate(),"日 "),o=this.formateNum(t.getHours(),":"),n=this.formateNum(t.getMinutes(),"");return i+a+s+o+n},hideLoadNotic:function(){var e=this;$(".J_proLoginClose").on("click",function(){e.config.elm.find(".J_notic").slideUp("fast","linear"),e.config.isLoginClose=!0})},loopGoods:function(e,s,o,r){var d=this,l=t.selected[e],c=[];if($.each(t.allGoods,function(t,i){if(parseFloat(i.level)===e+1){var a=!1;$.each(s,function(e,t){t.hasChild=!1,(i.name===t.value||t.name===i.name)&&(a=!0,i.name===t.value&&(t.isExist=!0,t.child=i.child),c.push(t))}),a||(s.push(i),c.push(i))}}),""!==l.val){var p=!1;$.each(s,function(e,t){t.value===l.val&&(l.index=e,p=!0)}),p||(0===r?(l.index="",l.val=""):(l.index=0,l.val=s[l.index].value))}else 0===r?(l.index="",l.val=""):(l.index=l.index,l.val=s[l.index].value);$.each(c,function(i,a){if(a.list){var s=t.selected[e+1].val;$.each(a.child,function(e,i){if(""!==s){if(i.value===s)return void(a.hasChild=!0)}else for(var o=t.allGoods,n=0,r=o.length;r>n;n++)if(parseFloat(a.level)+1===parseFloat(o[n].level)){i.value===o[n].name&&(a.hasChild=!1);break}})}else o&&o.child?$.each(o.child,function(e,t){t.value===a.value&&(a.hasChild=!0)}):a.hasChild=!0});var h={index:e,num:l,data:c,formateListPro:""===l.index?!1:!0,bigTagJson:t.bigTagJson,stockData:t.stockData,presalesData:t.presalesData,hdinfoData:t.hdinfoData,hdinfoBookingData:t.hdinfoBookingData,hdinfoPresalesData:t.hdinfoPresalesData,isAllBooking:t.isAllBooking},u="";if(u=doT.template(c[l.index]&&c[l.index].list?$("#J_proTmp").html():$("#J_proTmp2").html()),0===r?$(".J_step").eq(e).replaceWith(u(h)).find("img").each(function(){a.loadImage($(this))}):$("#J_list").append(u(h)).find("img").each(function(){a.loadImage($(this))}),l=l.index,s[l]&&s[l].list)this.loopGoods(e+1,s[l].list,s[l],r);else if(0===r){var g=$(".J_step").eq(e).find("li"),f=0,m=0,v=0;$.each(g,function(e){g.eq(e).hasClass("btn-hide")||(m++,f=e),(g.eq(e).hasClass("active")||g.eq(e).hasClass("active-disabled"))&&(v=e)}),this.selectStep(1),g.eq(1===m?f:v).trigger("click")}else{var _=s[l].goods.service_list;if(_?(u=i(27),$("#J_list").append(u(_)),$(".J_service").removeClass("hide"),$.map(_,function(e,i){e.service_info&&e.service_info.length>0&&$.map(e.service_info,function(e,a){e.is_check&&(t.services[i]={},t.services[i][e.service_goods_id]={id:e.service_goods_id,bargain_id:e.bargain_id,name:e.service_short_name,oriprice:e.service_market_price,price:e.service_price,source:e.source})})})):$(".J_service").remove(),s[l].goods.after_sale_info){var b=s[l].goods.after_sale_info||null,y=i(28);$("#J_policy").html(y(b)),b.company_info&&$("#J_aftersaleCompany").html(b.company_info.name).attr("type",b.company_info.business_type).attr("desc",JSON.stringify(b.company_info.desc))}else $("#J_policy").html(""),$("#J_aftersaleCompany").html("");u=doT.template($("#J_proImgTmp").html()),$("#J_sliderView").html(u(s[l].goods)),s[l].goods.images&&0!==s[l].goods.images.length&&n(),t.product={name:s[l].goods.goods_name,market_price:s[l].goods.market_price,price:s[l].goods.goods_price,shipment_text:s[l].goods.shipment_text||"",seckill:s[l].goods.seckill_action||null},t.id=s[l].goods.goods_id,t.cid=s[l].goods.commodity_id,t.type=s[l].goods.action.type,t.isbigtap=s[l].goods.action.isBigtap,d.relationCallback(),s[l].stock=d.getStockData(t.type,t.isbigtap?0:1);var k=d.getStockData(t.type,0)[t.id];k&&(t.hdendtime=k.endtime||0,t.hdstarttime=k.starttime||0),s[l].hdendtime=t.hdendtime,s[l].hdstarttime=t.hdstarttime,s[l].orderData=t.orderData,s[l].href=this.config.loginUrl,s[l].isLogin=this.config.isLogin,s[l].isAllGoodsBooking=t.isAllBooking,this.checkIsSeckill(s[l])}},formateSeckillTime:function(e){var t=new Date(1e3*parseInt(e)),i=t.getDate()+"日 ",a=this.formateNum(t.getHours(),":"),s=this.formateNum(t.getMinutes(),"");return"预计 "+i+a+s+" 开始"},checkIsSeckill:function(e){var i=this;t.seckillSale=!1;var a=$(".J_proPrice"),s=a.find(".seckill-notic");if(s.addClass("hide"),window.miCountdownTimer_seckill&&clearTimeout(window.miCountdownTimer_seckill),e.goods.seckill_action){var o=!1,n=!1,r=!1,d=e.goods.seckill_action.mode_start_time-e.goods.seckill_action.mode_change_time||120;$.miCountdown_seckill({startTime:e.goods.seckill_action.mode_start_time,endTime:e.goods.seckill_action.mode_end_time,upTime:!0,onTime:function(a){d>=a?(t.seckillSale=!0,r||(i.setBtn(6),i.setSeckill(s,e),r=!0),i.countTime(a,"seckillBefore")):o||(i.formateGoods(e),s.removeClass("hide").find("span").html(i.formateSeckillTime(e.goods.seckill_action.mode_start_time)),o=!0)},onStart:function(a){t.seckillSale=!0,n||(i.setBtn(5,{starttime:e.goods.seckill_action.mode_start_time,endtime:e.goods.seckill_action.mode_end_time}),i.setSeckill(s,e),n=!0),i.countTime(a,"seckill")},onEnd:function(){window.location.reload()}})}else this.formateGoods(e)},setSeckill:function(e,t){this.formateGoods(t),$(".seckill-notic").addClass("hide"),$(".J_proBook,#J_bookFlow,.J_proOrder").addClass("hide"),$(".J_proSeckill").removeClass("hide"),$(".J_seckillPrice").html(parseFloat(t.goods.seckill_action.seckill.seckill_price)),parseFloat(t.goods.market_price)>parseFloat(t.goods.seckill_action.seckill.seckill_price)?$(".J_seckillPrice").siblings("del").removeClass("hide"):$(".J_seckillPrice").siblings("del").addClass("hide"),$(".J_seckillPriceDel").html(parseFloat(t.goods.market_price)),this.formateProList(),this.setSaleNotic(t.goods.seckill_action.seckill)},seckillAdd:function(e){var i={obj:e,gid:t.id,addcartSource:"normal_seckill",extend_field:{end_time:e.data("starttime"),start_time:e.data("endtime")},sourceVal:"flashsale_bigtap",callback:function(e){e&&1===e.code?location.href=p.config.staticUrl:MI.alert({msg:e.msg||"加购失败，请稍等再试"})},overCallback:function(e){e.removeClass("btn-primary").addClass("btn-disabled").html("已抢光").removeClass("J_seckillBuyBtn")}};t.mihomeId>0&&(i.storage=t.mihomeId),MI.bigtap.init(i)},setBtn:function(e,i){if("subscribe"!==t.type&&"reserve"!==t.type||3===e){var a=$("#J_buyBtnBox").find(".btn");if(-1===e)return void a.replaceWith('<a href="'+this.config.loginUrl+'"  class="btn btn-primary btn-biglarge ">登录后购买</a>');if(1===e)return void a.replaceWith('<a href="javascript:void(0);" class="btn btn-primary  btn-biglarge J_proBuyBtn" '+(t.btnTxt[t.type]?' id="J_proAddcart" ':"")+' data-type="'+t.type+'" data-isbigtap="'+t.isbigtap+'" data-name="'+a.data("name")+'">'+(t.btnTxt[t.type]?t.btnTxt[t.type]:a.data("name"))+"</a>");if(2===e)return void a.replaceWith('<a data-sign="disabled" data-type="'+t.type+'" data-isbigtap="'+t.isbigtap+'" data-name="'+a.data("name")+'" class="btn btn-disabled btn-biglarge" href="javascript:void(0);" >暂时无法送达</a>');if(3===e)return void a.replaceWith('<a data-sign="disabled" data-type="'+t.type+'" data-name="'+a.data("name")+'" class="btn btn-disabled btn-biglarge" href="javascript:void(0);" >已预约</a>');if(4===e)return a.replaceWith('<a  class="btn btn-gray btn-biglarge btn-disabled" href="javascript:void(0);"  data-seckill="onsale"  data-type="'+t.type+'" data-isbigtap="'+t.isbigtap+'" data-name="'+a.data("name")+'" >已抢光</a>'),void $("#J_productStatus").removeClass("active noserver active presales booking").addClass("soldout");if(5===e)return a.replaceWith('<a  class="btn btn-primary btn-biglarge J_seckillBuyBtn" href="javascript:void(0);" data-seckill="onsale" data-starttime="'+i.starttime+'" data-endtime="'+i.endtime+'" data-isbigtap="'+t.isbigtap+'" data-name="'+a.data("name")+'" >立即抢购</a>'),void $("#J_productStatus").removeClass("soldout noserver active presales booking").addClass("active");if(6===e)return a.replaceWith('<a  class="btn btn-gray btn-biglarge btn-disabled J_remindnoStart" href="javascript:void(0);"  data-seckill="onsale"  data-type="'+t.type+'" data-isbigtap="'+t.isbigtap+'" data-name="'+a.data("name")+'" >立即抢购</a>'),void $("#J_productStatus").removeClass("soldout noserver active presales booking").addClass("active");"presales"!=t.type&&"booking"!=t.type&&"bigtap"!=t.type||!t.isbigtap?(a.replaceWith('<a data-sign="disabled" data-type="'+t.type+'" data-isbigtap="'+t.isbigtap+'" data-name="'+a.data("name")+'" class="btn btn-line-primary btn-biglarge J_setRemind" href="javascript:void(0);" >到货通知</a>'),r({buyModule:p,_config:t})):(a.replaceWith('<a data-sign="disabled" data-type="'+t.type+'" data-isbigtap="'+t.isbigtap+'" data-name="'+a.data("name")+'" class="btn btn-disabled btn-biglarge" href="javascript:void(0);" >暂时缺货</a>'),this.changeAddress().setAddressStatusSoldout()),this.setStepLi()}},setSaleNotic:function(e){return e.is_activity||e.is_coupon?(e.is_activity||$(".J_flowWrap").addClass("hide"),void(e.is_coupon||$(".J_couponWrap").addClass("hide"))):void $(".J_saleWrap").addClass("hide")},formateGoods:function(e,a){var s=this;if(tmp=i(29),$("#J_buyBtnBox").html(tmp(e)),$(".J_proPrice").find(".price").html(t.product.price+"元 "+(t.product.shipment_text?"<em>("+t.product.shipment_text+")</em>":"")+(parseFloat(t.product.market_price)>parseFloat(t.product.price)?"<del>"+t.product.market_price+"元</del>":"")),t.seckillSale)return $(".J_hasChange").remove(),void this.getSeckillHdinfor(e.goods);if($(".J_proOrder,.J_proSeckill").addClass("hide"),"booking"===t.type){$(".J_proBook,#J_bookFlow").removeClass("hide");var o=e.goods.sale_mode_info.value;t.bookPrice=o.price,$(".J_bookPrice").html(o.price),t.bookStarttime=o.pre_start_time,t.bookEndtime=o.pre_end_time,s.getTime(),t.saltTitle=o.sale_title,$("#J_bookFlow").find(".item-infor").eq(0).html(s.formatBookTime(o.pre_start_time)+" - "+s.formatBookTime(o.pre_end_time)).end().eq(1).html(s.formatBookTime(o.final_start_time)+" - "+s.formatBookTime(o.final_end_time)).end().eq(2).html(t.saltTitle),window.getBookRule||(window.getBookRule=!0,this.getBookRule())}else $(".J_proBook,#J_bookFlow,.J_proSeckill").addClass("hide"),("subscribe"===t.type||"reserve"===t.type)&&($(".J_proOrder").removeClass("hide"),$(".J_orderPrice").html(t.product.price+(t.product.shipment_text?"<em>("+t.product.shipment_text+")</em>":"")+(parseFloat(t.product.market_price)>parseFloat(t.product.price)?"<del>￥"+t.product.market_price+"</del>":"")),t.subscribe=e.goods.sale_mode_info.value,s.getTime(),(t.isAllBooking===!1||t.defaultOnce===!1)&&this.getorderDatacheck());"presales"===t.type&&e.goods.sale_mode_info&&(t.saltTitle=e.goods.sale_mode_info.value.sale_title),s.formateProList()},getSeckillHdinfor:function(e){if(!this.config.isLogin)return void this.setBtn(-1);var i=this;a.ajax({url:MI.GLOBAL_CONFIG.damiaoSite+"hdinfo/cn",data:{sitename:"cn",storage:t.mihomeId,start:e.seckill_action.mode_start_time,source:"flashsale_bigtap",m:1},jsonp:"jsonpcallback",jsonpCallback:"hdinfo_"+e.goods_id,error:function(){i.setBtn(4)},callback:function(t){if(t&&t.status){var a=t.status;a[e.goods_id]?2===a[e.goods_id].hdstatus?i.setBtn(5,{starttime:e.seckill_action.mode_start_time,endtime:e.seckill_action.mode_end_time}):i.setBtn(1===a[e.goods_id].hdstatus?6:4):i.setBtn(4)}else i.setBtn(4)}})},getBookRule:function(){a.ajax({url:this.config.bookRule,data:{product_id:t.id},callback:function(e){e&&1===e.code?($(".J_bookRuleTips").removeClass("hide"),$(".J_bookRuleCon").find("div").html(e.data.rules_detail)):$(".J_bookRuleTips").addClass("hide")}})},getorderDatacheck:function(){var e=this;t.orderDataId.length>0&&a.ajax({url:e.config.orderDatacheck+"?goods_id_list="+t.orderDataId.join(",")+"&appointment_batch="+t.subscribe.batch_key+"&is_limit_some_sku="+t.subscribe.is_limit_some_sku,callback:function(i){if(1===i.code&&i.data&&i.data.list)if(t.orderData=i.data.list,t.subscribe.is_limit_some_sku)t.orderData[t.id]&&e.setBtn(3);else for(var a in t.orderData)if(t.orderData[a]){e.setBtn(3);break}}})},stockCheckInit:function(){for(var e=this,i=t.allGoods,a="",s=0,o=i.length;o>s;s++){var n=i[s],r=!1;if(n.action&&("common"!==n.action&&"glass"!==n.action?(r=!0,t.id=n.id):(a=e.getStockData(n.action,1),a&&a[n.id]&&(r=!0,t.id=n.id)),r)){t.selected[parseFloat(n.level)-1].val=n.name;for(var d=0;o>d;d++){var l=i[d].child;if(l)for(var c=0;c<l.length;c++)if(l[c].id===n.id){t.selected[parseFloat(i[d].level)-1].val=i[d].name;break}}break}if(!n.action){for(var p=!1,h=0,u=n.child.length;u>h;h++){var g=n.child[h];if("common"!==g.action&&"glass"!==g.action?r=!0:(a=e.getStockData(g.action,1),a&&a[g.id]&&(r=!0)),r){t.selected[parseFloat(n.level)-1].val=n.name,t.selected[parseFloat(g.level)-1].val=g.value,t.id=g.id,p=!0;break}}if(p)break}}t.id||this.searchChild(i[0])},searchChild:function(e){e.child&&e.child.length>0?this.searchChild(e.child[0]):t.id=e.id},formatPro:function(){var e=this;if(e.config.isLogin||(e.config.list.isLogin=e.config.isLogin,e.config.list.href=e.config.loginUrl,e.config.elm.find(".J_proLogin").attr("href",e.config.loginUrl).end().find(".J_notic").removeClass("hide")),e.config.elm.find(".J_error,.J_load").addClass("hide").end().find(".J_main").removeClass("hide"),t.services={},$("#J_list").html(""),e.loopGoods(0,e.config.list.list),e.selectStep(),e.selectService(),window.getAddressStock||e.addressInit(t.isbigtap),e.formateProList(),"onsale"!==$("#J_buyBtnBox").find(".btn").data("seckill")){"subscribe"===t.type||"reserve"===t.type?e.changeAddress().setSoldout():(1===window.AddressCbData.data.can_delivery?"disabled"===$("#J_buyBtnBox").find(".btn").data("sign")?e.changeAddress().setAddressStatusSoldout():(e.changeAddress().setBuy(window.AddressCbData),e.changeAddress().changRelation()):e.changeAddress().setNoserver(window.AddressCbData),$("#J_buyBtnBox").find(".btn").hasClass("J_setRemind")&&r({buyModule:p,_config:t}));var i=0,a=setInterval(function(){window.flowData&&(d({_config:t,acts_info:e.config.acts_info}).setFlow(t.id),clearInterval(a),t.seckillSale&&e.setSaleNotic(e.config._config.product.seckill.seckill)),i>=50&&clearInterval(a),i++},100);this.config.isLogin&&!t.isbigtap&&this.checkLike()}},addressInit:function(e){t.selectedAddr.length?this.checkSelectAddr(e):(this.chooseRegionsInit(e),t.coupon||(d({_config:t,acts_info:this.config.acts_info}).init(),t.coupon=!0))},chooseRegionsInit:function(e,i){var a=this;MI.buyChooseAddress.init({showTrigger:"#J_switchChooseRegions",afterChoose:function(s,o){s&&s.length&&(t.selectedAddr=s,o&&(t.mihomeId=o),$("#J_modalChooseRegions").modal("hide"),a.checkSelectAddr(e,i))}})},checkLike:function(){a.ajax({url:this.config.orderSite+"/favorite/check/id/"+t.cid,data:{},callback:function(e){e&&1==e.code?$("#J_like").addClass("current"):$("#J_like").removeClass("current")}})},changeLike:function(){var e=this;$("body").on("click","#J_like",function(){a.ajax($("#J_like").hasClass("current")?{url:e.config.orderSite+"/favorite/drop/id/"+t.cid,data:{},callback:function(e){e&&1==e.code&&($("#J_like").removeClass("current"),$(".J_redCopy").removeClass("redsd"))}}:{url:e.config.orderSite+"/favorite/add/id/"+t.cid,data:{},callback:function(e){e&&1==e.code&&($("#J_like").addClass("current"),$(".J_redCopy").addClass("redsd"))}})})},setStepLi:function(){var e=$(".J_step").length,t=$(".J_step").eq(e-1).find("li");t.filter(".active").addClass("active-disabled")},changeAddress:function(){var e=this,i=$("#J_productStatus");return{changRelation:function(){var i=$("#J_relation");"disabled"!==$("#J_buyBtnBox").find(".btn").data("sign")?(e.relation&&e.relation.length>0&&""!==i.attr("style")&&i.stop().animate({height:"133px"},300,"linear",function(){i.attr("style","")}),t.isbigtap&&(e.getStockData(t.type,0).length>0&&e.getStockData(t.type,0)[t.id].hdstatus>=3?e.setBtn():(e.countDown(),e.changeAddress().setBuy()))):(e.relation&&e.relation.length>0&&i.stop().animate({height:0},300,"linear",function(){i.css("overflow","hidden")}),"booking"===t.type&&t.isbigtap?e.countDown():r({buyModule:p,_config:t}))},setBtnRemind:function(){this.changRelation()},setNoAddress:function(){i.addClass("nohas").removeClass("noserver over active presales booking").find(".time").html("")},setNoserver:function(){e.setBtn(2),i.addClass("noserver").removeClass("nohas over active presales booking").find(".time").html("")},setAddressStatusSoldout:function(){i.addClass("soldout").removeClass("nohas active noserver presales booking").find(".time").html("")},setSoldout:function(){("common"===t.type||"bigtap"===t.type||"presales"===t.type||"booking"===t.type||"glass"===t.type)&&this.setBtnRemind(),this.setAddressStatusSoldout()},setBuy:function(a){return t.seckillSale?void i.removeClass("soldout noserver active presales booking").addClass("active"):"subscribe"===t.type||"reserve"===t.type?void this.setAddressStatusSoldout():(i.removeClass("soldout noserver active presales booking").find(".time").html(a?a.data.est_delivery_desc:""),"presales"===t.type?(i.addClass("presales"),i.find(".time").html(t.saltTitle)):"booking"===t.type?(i.addClass("booking"),i.find(".time").html(t.saltTitle)):i.addClass("active"),void(t.isbigtap||e.setBtn(1)))},changgeInfor:function(i){if("subscribe"===t.type||"reserve"===t.type)return void e.changeAddress().setSoldout();if(1===i.data.can_delivery)if(i.data.is_cos)e.changeAddress().setSoldout();else{if("onsale"===$("#J_buyBtnBox").find(".btn").data("seckill"))return void e.changeAddress().setBuy(i);"disabled"===$("#J_buyBtnBox").find(".btn").data("sign")?e.changeAddress().setSoldout():(e.changeAddress().setBuy(i),e.changeAddress().changRelation())}else e.changeAddress().setNoserver(i)}}},checkSelectAddr:function(){window.getAddressStock=!0;var e=this;if(this.selectStockInit||(this.stockCheckInit(),this.selectStockInit=!0),"common"===t.type&&"presales"===t.type&&"booking"===t.type&&"bigtap"===t.type&&"glass"===t.action)return void e.changeAddress().setNoAddress();var i=t.selectedAddr.length>4?1:0,s={product_id:t.id,item_id:0,province_id:t.selectedAddr[i+0].id,city_id:t.selectedAddr[i+1].id,district_id:t.selectedAddr[i+2].id,area:t.selectedAddr[i+3].id};("presales"===t.type||"booking"===t.type)&&(s.is_presale=1),a.ajax({url:MI.GLOBAL_CONFIG.orderSite+"/api/deliverySearch.php",data:s,error:function(){e.changeAddress().setNoserver()},callback:function(i){i.isbigtap=t.isbigtap,i&&1===i.code&&1===i.data.can_delivery?(i.data.mihome_id&&(t.mihomeId=i.data.mihome_id),e.changeAddress().changgeInfor(i)):e.changeAddress().setNoserver(),window.AddressCbData=i,e.getGoodsStock()}})},loopCheckIsBigtag:function(e,i){var a=i[parseFloat(t.selected[e].index)];return(!a||a&&!a.price_min)&&(a=i[0]),a&&a.list?void this.loopCheckIsBigtag(e+1,a.list):(a=a.goods,a.action&&("bigtap"===a.action.type||"booking"===a.action.type&&a.action.isBigtap||"presales"===a.action.type&&a.action.isBigtap)?(t.type=a.action.type,t.isbigtap=a.action.isBigtap,t.id=a.goods_id,void this.getHdInfoStatus(t.type)):void this.formatPro())},setSelectIndex:function(e,i,a){for(var s=0,o=t.selected.length;o>s;s++)if(s===e){t.selected[s]={val:i,index:a};break}},unselected:function(e,i){if(t.selected[e].val=i,t.selected[t.selected.length-1].child=[],!(0>e)){var a=!1;$.each(t.allGoods,function(s,o){o.child.length>0&&$.each(o.child,function(s,n){n.value!==i||a||(t.selected[e-1].val=o.name,t.selected[e-1].index=o.level,2>e&&(t.selected[e+1].val=o.child[0].val),a=!0)})})}},selectStep:function(e){var i=this,s=$(".J_step");s.find("li").on("click",function(){window.setFormatPro=!1,t.isAllBooking=!1,t.defaultOnce=!1;var o=$(this);if(!o.hasClass("active")&&!o.hasClass("active-disabled")||e){var n=o.parents(".J_step"),r=n.data("index");if(r===s.length-1){if(o.hasClass("disabled")&&parseFloat(o.data("childlen"))>=1)return i.unselected(n.data("index"),o.data("value")),void i.getGoodsStock();i.setSelectIndex(r,String(o.data("value")),o.data("index")),i.getGoodsStock()}else i.setSelectIndex(r,String(o.data("value")),o.data("index")),i.loopGoods(0,i.config.list.list,"",0);$(".step-list").find("img").each(function(){a.loadImage($(this))})}})},getGoodsStock:function(){if(t.stockDataId.length>0){var e=this,i={url:e.config.orderapi+"/stock/listv2?gids="+t.stockDataId.join(","),error:function(){e.checkPresalesDataId()},callback:function(i){t.stockData=i.data,e.checkPresalesDataId()}};if(t.mihomeId){var s=t.selectedAddr.length>4?1:0;i.data={mihome_id:t.mihomeId,province_id:t.selectedAddr[s+0].id,city_id:t.selectedAddr[s+1].id,district_id:t.selectedAddr[s+2].id,area:t.selectedAddr[s+3].id}}a.ajax(i)}else this.checkPresalesDataId()},getStockDataName:function(e){var i={0:"stockData",1:"stockData"};return t.bigTagJson[e]&&(i=t.bigTagJson[e]),i},getStockData:function(e,i){return t[this.getStockDataName(e)[i]]},selectFirstStock:function(e){for(var i=this,a=e||t.allGoods,s="",o=0,n=a.length;n>o;o++){var r=a[o],d=!1;if(r.action&&(r.isbigtap?(s=i.getStockData(r.action,0),s&&s[r.id]&&2===s[r.id].hdstatus&&(d=!0)):(s=i.getStockData(r.actio,1),s&&s[r.id]&&(d=!0)),d)){t.selected[parseFloat(r.level)-1].val=r.name;for(var l=0;n>l;l++){var c=a[l].child;if(c)for(var p=0;p<c.length;p++)if(c[p].id===r.id){t.selected[parseFloat(a[l].level)-1].val=a[l].name;break}}break}if(!r.action){for(var h=!1,u=0,g=r.child.length;g>u;u++){var f=r.child[u];if(f.isbigtap?(s=i.getStockData(f.action,0),s&&s[r.id]&&2===s[r.id].hdstatus&&(d=!0)):(s=i.getStockData(f.action,1),s&&s[f.id]&&(d=!0)),d){t.selected[parseFloat(r.level)-1].val=r.name,t.selected[parseFloat(f.level)-1].val=f.value,h=!0;break}}if(h)break}}},checkPresalesDataId:function(){t.presalesDataId.length>0?this.getPresalesInfo():t.bigtapDataId.length>0?this.loopBigtap():this.formatPro()},getPresalesInfo:function(){var e=this,i={};if(t.mihomeId){var s=t.selectedAddr.length>4?1:0;i={mihome_id:t.mihomeId,province_id:t.selectedAddr[s+0].id,city_id:t.selectedAddr[s+1].id,district_id:t.selectedAddr[s+2].id,area:t.selectedAddr[s+3].id}}i.channel="presales",a.ajax({url:e.config.orderapi+"/stock/listv2?gids="+t.presalesDataId.join(","),data:i,error:function(){e.checkBigtapDataId()},callback:function(i){t.presalesData=i.data,e.checkBigtapDataId()}})},checkBigtapDataId:function(){t.bigtapDataId.length>0?this.loopBigtap():this.formatPro()},loopBigtap:function(){var e=this;$.each(t.bigtapDataType,function(t,i){e.getHdInfoStatus(i,t)})},getHdInfoStatus:function(e,i){var s=this,o={m:1,source:"bigtap"};t.mihomeId&&(o.storage=t.mihomeId),("presales"===e||"booking"===e)&&(o.source=e+"_bigtap"),a.ajax({url:MI.GLOBAL_CONFIG.damiaoSite+"hdinfo/cn",data:o,jsonp:"jsonpcallback",jsonpCallback:"hdinfo_"+o.source,error:function(){s.formatPro()},callback:function(a){"presales"===e?t.hdinfoPresalesData=a.status:"booking"===e?t.hdinfoBookingData=a.status:t.hdinfoData=a.status,void 0!=i?i==t.bigtapDataType.length-1&&s.formatPro():s.formatPro()}})},checkProSelected:function(e){for(var t=$(".J_step"),i=0,a=t.length;a>i;i++)if(i>0&&!t.eq(i).find(".active").length&&!t.eq(i).find(".active-disabled").length)return void MI.alert({msg:"请"+t.eq(i).find(".step-title").data("name"),isConfirm:!1});e()},bigtapAdd:function(e){var i="bigtap";("presales"===t.type||"booking"===t.type)&&(i=t.type+"_bigtap");var a={obj:e,gid:t.id,callback:p.succCallback,sourceVal:i,overCallback:function(e){e.removeClass("btn-primary").addClass("btn-disabled").html("暂时缺货").removeClass("J_proBuyBtn")}};t.mihomeId>0&&(a.storage=t.mihomeId),MI.bigtap.init(a)},succCallback:function(e){var i="";e&&1===e.code?(i="booking"===t.type||"glass"===t.type?p.config.orderSite+"/buy/checkout?quick_order=1":p.config.staticUrl+t.id+"&protype=product&pid="+t.pid,t.pid=e.message,p.checkServices(i)):1!==e.code&&MI.alert({msg:e.msg})},checkParts:function(e){if(t.parts.length){var i=0,a=[];$.each(t.parts,function(s,o){return a.push(o.is_bargain?o.bargain_id:o.id),i>=t.parts.length-1?void MI.addShopCart(a.join("_"),function(t){location.href=e+"&relation="+(t&&1===t.code?"success":"fail")},$(".J_proBuyBtn")):void(i+=1)})}else location.href=e},addCartServices:function(e,i,a,s){MI.addShopCart(e,function(e){e&&1===e.code||(p.addServicefail=!0),p.addServiceIndex===a-1&&(i+=i+"&insurance="+(p.addServicefail?"fail":"success"),p.checkParts(i)),p.addServiceIndex++},$(".J_proBuyBtn"),{parent_itemId:t.pid,source:s})},checkServices:function(e){var i=this;if($.isEmptyObject(t.services))p.checkParts(e);else{var a=[];for(var s in t.services)for(var o in t.services[s])a.push(t.services[s][o]);p.addServicefail=!1,p.addServiceIndex=0,a.forEach(function(t,s){setTimeout(function(){i.addCartServices(t.bargain_id,e,a.length,t.source)},500*s)})}},addCart:function(){var e=this;$("body").on("click",".J_proBuyBtn",function(){var i=$(this);e.checkProSelected(function(){return"common"===t.type?void MI.addShopCart(t.id,p.succCallback):"presales"===t.type?void($(i).data("isbigtap")?e.bigtapAdd($("#J_proAddcart")):MI.addShopCart(t.id,p.succCallback,$("#J_proAddcart"),{source:"presales"})):"glass"===t.type?void(e.config.isLogin?($("#J_orderModalGlassBuy").modal("show"),MI.glassBuy(t.id,function(e,t){MI.addShopCart(t,p.succCallback,$("#J_GlassAddCart"),{source:"glasses",extend_field:e})})):window.location.href=e.config.loginUrl):"booking"===t.type?void($(i).data("isbigtap")?e.bigtapAdd($("#J_proAddcart")):MI.addShopCart(t.id,p.succCallback,$("#J_proAddcart"),{source:"booking"})):"subscribe"===t.type?void l({_config:t,need_address:!0}).init():"reserve"===t.type?void l({_config:t,need_address:!1}).init():void e.bigtapAdd($("#J_proAddcart"))})}),$("body").on("click",".J_seckillBuyBtn",function(){e.seckillAdd($(".J_seckillBuyBtn"))})},loopGoodsList:function(e,i){var a=this;$.each(i,function(i,s){var o=s.list||[],n=[];s.list&&$.each(s.list,function(e,t){n.push({value:t.value,level:t.level,isbigtap:t.goods&&t.goods.action?t.goods.action.isBigtap:!1,
action:t.goods&&t.goods.action?t.goods.action.type:"",id:t.goods&&t.goods.goods_id?t.goods.goods_id:0})}),t.allGoods.push({title:s.name,name:s.value,level:s.level,child:n,isbigtap:s.goods&&s.goods.action?s.goods.action.isBigtap:!1,action:s.goods&&s.goods.action?s.goods.action.type:"",id:s.goods&&s.goods.goods_id?s.goods.goods_id:0,icon_url:s.goods&&s.goods.icon_url?s.goods.icon_url:"",image:s.goods&&s.goods.image?s.goods.image:""}),o.length>0?a.loopGoodsList(e+1,o):(o=s.goods||[],"bigtap"===o.action.type?(t.bigtapDataId.push({id:o.goods_id,type:o.action.type}),t.bigtapDataType.push(o.action.type)):"presales"===o.action.type||"booking"===o.action.type?o.action.isBigtap?(t.bigtapDataId.push({id:o.goods_id,type:o.action.type}),t.bigtapDataType.push(o.action.type)):t.presalesDataId.push(o.goods_id):(("common"===o.action.type||"glass"===o.action.type)&&t.stockDataId.push(o.goods_id),("subscribe"===o.action.type||"reserve"===o.action.type)&&t.orderDataId.push(o.goods_id)))}),t.bigtapDataType=a.uniqueArr(t.bigtapDataType),t.selected.push({index:0,val:""})},uniqueArr:function(e){for(var t=[],i={},a=0;a<e.length;a++)i[e[a]]||(t.push(e[a]),i[e[a]]=1);return t},unique:function(e){for(var i=[e[0]],a=1,s=e.length;s>a;a++){for(var o=!1,n=0,r=i.length;r>n;n++)if(e[a].name===i[n].name&&e[a].level===i[n].level){o=!0;break}o||(i.push(e[a]),t.sortData.push(e[a].name))}return i},reloadFun:function(){var e=this;$(".J_reload").on("click",function(){$(".J_load").removeClass("hide"),$(".J_error").addClass("hide"),e.setAjaxInt()})},showError:function(e){$(".J_load").addClass("hide"),e=e?e:"有点小问题，请点击按钮刷新重试",$(".J_error").removeClass("hide").find("h3").html(e)},checkIsAllBookingGoods:function(e){e.is_choose===!0?t.isAllBooking=!1:$.each(e.list,function(e,i){i.goods&&i.goods.action&&!i.list&&"subscribe"!==i.goods.action.type&&"reserve"!==i.goods.action.type&&(t.isAllBooking=!1),i.list&&$.each(i.list,function(e,i){"subscribe"!==i.goods.action.type&&"reserve"!==i.goods.action.type&&(t.isAllBooking=!1)})})},setAjaxInt:function(){var e=this;setTimeout(function(){a.ajax({url:e.config.orderGet,data:{product_id:t.pid},jsonpCallback:"proget2callback",error:function(i,a,s){var o={product_id:t.pid,locationHref:window.location.href,errorData:i,errorType:a,error:s};_msq.push(["trackEvent","AJAX_ERROR",encodeURIComponent(e.config.orderGet),JSON.stringify(o)]),e.showError()},callback:function(i){if(0===i.code){c(i.data.tab_info||{}),e.config.list=i.data,e.config.acts_info=i.data.acts_info||null,e.checkIsAllBookingGoods(e.config.list);var a=doT.template($("#J_addressTmp").html());e.config.list.isLogin=e.config.isLogin,e.config.list.href=e.config.loginUrl,t.loginUrl=e.config.loginUrl,e.addCart(),t.commodityIds=i.data.commodity_ids,""!==i.data.product_desc_ext&&$("#J_desc").html(i.data.product_desc_ext),""!==i.data.name&&(t.proName=i.data.name,$(".J_proName").find(".name").html(t.proName),i.data.price_tips&&!$.isEmptyObject(i.data.price_tips)&&$(".J_proName").find(".img").html('<img src="'+i.data.price_tips.img_url+'"/>')),e.loopGoodsList(0,e.config.list.list),t.allGoods=e.unique(t.allGoods),$(".J_addressWrap").html(a()).removeClass("hide"),e.addressInit(),e.setReleation(i.data.extend_info||null)}else e.showError(i.msg)}})},500)},setReleation:function(e){var t=this;if(e&&(t.relation=e.relation,e.info&&e.info.desc_tabs_view&&e.info.desc_tabs_view.length>0)){tmp=i(30),$("#J_proInfo").append(tmp(e.info.desc_tabs_view[0])).find(".J_imgBox").each(function(){$(this).slider({auto:!0,pager:!0,infiniteLoop:!0})});for(var s=$(".J_markdown"),o=0;o<s.length;o++)s.eq(o).html(window.marked(s.eq(o).data("desc")));var n=$(".section");n.visibleWatcher({offset:100,onVisible:function(e,t){n.filter(function(e){return t+1>=e}).addClass("preload").find("img").each(function(){a.loadImage($(this))})}})}},relationCallback:function(){var e=this,i="",a={cid:t.cid,data:e.relation};if(e.relation){if(0===e.relation.length)return void $("#J_relation").addClass("hide");$("#J_relation").removeClass("hide"),i=doT.template($("#J_relationTmp").html());var s=0;$("#J_relation").html(i(a)).find(".list").find("li").find("del").each(function(){s+=parseFloat($(this).data("maxsave"))}),s>0&&($(".J_saleMax").removeClass("hide"),$(".J_salePrice").html(s)),e.selectList($("#J_parts"),"parts"),e.selectList($("#J_install"),"install");var o=t.parts;t.parts=[],$.each(o,function(e,t){$("#J_relation").find(".list").find("li").eq(t.index).find("i").click().end().find("a").eq(t.item).click()})}},bindFun:function(){$(".J_bookRule,.J_bookRuleCon").hover(function(){$(".J_bookRuleCon").removeClass("hide")},function(){$(".J_bookRuleCon").addClass("hide")}),$("body").on("click",".J_remindnoStart",function(){MI.alert({msg:"活动未开始"})}),$("body").on("click","#J_aftersaleCompany",function(){if("2"===$("#J_aftersaleCompany").attr("type")){var e=JSON.parse($("#J_aftersaleCompany").attr("desc"));$("#J_aftersaleModal").modal("show").find(".modal-con").html(e.desc.replace(/ /g,"&nbsp;").replace(/\n/g,"</br />")).end().find(".title").html(e.title)}})},init:function(){this.hideLoadNotic(),o(),this.reloadFun(),this.setAjaxInt(),this.bindFun(),this.changeLike()}};p.init()},$(document).ready(function(){$.productBuy({id:window.proBuy_id})})},function(e,t){!function(e){function t(t){function i(){for(var t=-1,i=e(document).scrollTop(),a=0,s=l.length;s>a&&i+n.viewport.height()>l[a];a+=1)t+=1;return t}function a(){var t=i();d!==t&&(d=t,r.filter(function(t){return d>=t&&!e(this).hasClass(n.visibleClass)}).addClass(n.visibleClass).trigger("visible.visibleWatcher"),n.onVisible(r.eq(d),d))}function s(){r.each(function(){var t=e(this).attr("data-offset")?Number(e(this).attr("data-offset")):n.offset,i=t%1===0?t:t*n.viewport.height();l.push(e(this).offset().top+i)}),a(),n.onLoad()}var o,n,r=e(this),d=-1,l=[];o={viewport:e(window),visibleClass:"is-visible",offset:300,onLoad:e.noop,onVisible:e.noop},n=e.extend({},o,t),s(),n.viewport.on({"scroll.visibleWatcher":a,"resize.visibleWatcher":s})}e.fn.visibleWatcher=function(e){return t.call(this,e),this}}(jQuery)},function(e,t,i){(function(t){(function(){function t(e){this.tokens=[],this.tokens.links={},this.options=e||c.defaults,this.rules=p.normal,this.options.gfm&&(this.rules=this.options.tables?p.tables:p.gfm)}function i(e,t){if(this.options=t||c.defaults,this.links=e,this.rules=h.normal,this.renderer=this.options.renderer||new a,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.rules=this.options.breaks?h.breaks:h.gfm:this.options.pedantic&&(this.rules=h.pedantic)}function a(e){this.options=e||{}}function s(e){this.tokens=[],this.token=null,this.options=e||c.defaults,this.options.renderer=this.options.renderer||new a,this.renderer=this.options.renderer,this.renderer.options=this.options}function o(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function n(e){return e.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/g,function(e,t){return t=t.toLowerCase(),"colon"===t?":":"#"===t.charAt(0)?String.fromCharCode("x"===t.charAt(1)?parseInt(t.substring(2),16):+t.substring(1)):""})}function r(e,t){return e=e.source,t=t||"",function i(a,s){return a?(s=s.source||s,s=s.replace(/(^|[^\[])\^/g,"$1"),e=e.replace(a,s),i):new RegExp(e,t)}}function d(){}function l(e){for(var t,i,a=1;a<arguments.length;a++){t=arguments[a];for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}function c(e,i,a){if(a||"function"==typeof i){a||(a=i,i=null),i=l({},c.defaults,i||{});var n,r,d=i.highlight,p=0;try{n=t.lex(e,i)}catch(h){return a(h)}r=n.length;var u=function(e){if(e)return i.highlight=d,a(e);var t;try{t=s.parse(n,i)}catch(o){e=o}return i.highlight=d,e?a(e):a(null,t)};if(!d||d.length<3)return u();if(delete i.highlight,!r)return u();for(;p<n.length;p++)!function(e){return"code"!==e.type?--r||u():d(e.text,e.lang,function(t,i){return t?u(t):null==i||i===e.text?--r||u():(e.text=i,e.escaped=!0,void(--r||u()))})}(n[p])}else try{return i&&(i=l({},c.defaults,i)),s.parse(t.lex(e,i),i)}catch(h){if(h.message+="\nPlease report this to https://github.com/chjj/marked.",(i||c.defaults).silent)return"<p>An error occured:</p><pre>"+o(h.message+"",!0)+"</pre>";throw h}}var p={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:d,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:d,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:d,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};p.bullet=/(?:[*+-]|\d+\.)/,p.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,p.item=r(p.item,"gm")(/bull/g,p.bullet)(),p.list=r(p.list)(/bull/g,p.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+p.def.source+")")(),p.blockquote=r(p.blockquote)("def",p.def)(),p._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",p.html=r(p.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,p._tag)(),p.paragraph=r(p.paragraph)("hr",p.hr)("heading",p.heading)("lheading",p.lheading)("blockquote",p.blockquote)("tag","<"+p._tag)("def",p.def)(),p.normal=l({},p),p.gfm=l({},p.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),p.gfm.paragraph=r(p.paragraph)("(?!","(?!"+p.gfm.fences.source.replace("\\1","\\2")+"|"+p.list.source.replace("\\1","\\3")+"|")(),p.tables=l({},p.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),t.rules=p,t.lex=function(e,i){var a=new t(i);return a.lex(e)},t.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},t.prototype.token=function(e,t,i){for(var a,s,o,n,r,d,l,c,h,e=e.replace(/^ +$/gm,"");e;)if((o=this.rules.newline.exec(e))&&(e=e.substring(o[0].length),o[0].length>1&&this.tokens.push({type:"space"})),o=this.rules.code.exec(e))e=e.substring(o[0].length),o=o[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?o:o.replace(/\n+$/,"")});else if(o=this.rules.fences.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"code",lang:o[2],text:o[3]||""});else if(o=this.rules.heading.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"heading",depth:o[1].length,text:o[2]});else if(t&&(o=this.rules.nptable.exec(e))){for(e=e.substring(o[0].length),d={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/\n$/,"").split("\n")},c=0;c<d.align.length;c++)d.align[c]=/^ *-+: *$/.test(d.align[c])?"right":/^ *:-+: *$/.test(d.align[c])?"center":/^ *:-+ *$/.test(d.align[c])?"left":null;for(c=0;c<d.cells.length;c++)d.cells[c]=d.cells[c].split(/ *\| */);this.tokens.push(d)}else if(o=this.rules.lheading.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"heading",depth:"="===o[2]?1:2,text:o[1]});else if(o=this.rules.hr.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"hr"});else if(o=this.rules.blockquote.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"blockquote_start"}),o=o[0].replace(/^ *> ?/gm,""),this.token(o,t,!0),this.tokens.push({type:"blockquote_end"});else if(o=this.rules.list.exec(e)){for(e=e.substring(o[0].length),n=o[2],this.tokens.push({type:"list_start",ordered:n.length>1}),o=o[0].match(this.rules.item),a=!1,h=o.length,c=0;h>c;c++)d=o[c],l=d.length,d=d.replace(/^ *([*+-]|\d+\.) +/,""),~d.indexOf("\n ")&&(l-=d.length,d=this.options.pedantic?d.replace(/^ {1,4}/gm,""):d.replace(new RegExp("^ {1,"+l+"}","gm"),"")),this.options.smartLists&&c!==h-1&&(r=p.bullet.exec(o[c+1])[0],n===r||n.length>1&&r.length>1||(e=o.slice(c+1).join("\n")+e,c=h-1)),s=a||/\n\n(?!\s*$)/.test(d),c!==h-1&&(a="\n"===d.charAt(d.length-1),s||(s=a)),this.tokens.push({type:s?"loose_item_start":"list_item_start"}),this.token(d,!1,i),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(o=this.rules.html.exec(e))e=e.substring(o[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===o[1]||"script"===o[1]||"style"===o[1]),text:o[0]});else if(!i&&t&&(o=this.rules.def.exec(e)))e=e.substring(o[0].length),this.tokens.links[o[1].toLowerCase()]={href:o[2],title:o[3]};else if(t&&(o=this.rules.table.exec(e))){for(e=e.substring(o[0].length),d={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/(?: *\| *)?\n$/,"").split("\n")},c=0;c<d.align.length;c++)d.align[c]=/^ *-+: *$/.test(d.align[c])?"right":/^ *:-+: *$/.test(d.align[c])?"center":/^ *:-+ *$/.test(d.align[c])?"left":null;for(c=0;c<d.cells.length;c++)d.cells[c]=d.cells[c].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(d)}else if(t&&(o=this.rules.paragraph.exec(e)))e=e.substring(o[0].length),this.tokens.push({type:"paragraph",text:"\n"===o[1].charAt(o[1].length-1)?o[1].slice(0,-1):o[1]});else if(o=this.rules.text.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"text",text:o[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var h={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:d,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:d,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};h._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,h._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,h.link=r(h.link)("inside",h._inside)("href",h._href)(),h.reflink=r(h.reflink)("inside",h._inside)(),h.normal=l({},h),h.pedantic=l({},h.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),h.gfm=l({},h.normal,{escape:r(h.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:r(h.text)("]|","~]|")("|","|https?://|")()}),h.breaks=l({},h.gfm,{br:r(h.br)("{2,}","*")(),text:r(h.gfm.text)("{2,}","*")()}),i.rules=h,i.output=function(e,t,a){var s=new i(t,a);return s.output(e)},i.prototype.output=function(e){for(var t,i,a,s,n="";e;)if(s=this.rules.escape.exec(e))e=e.substring(s[0].length),n+=s[1];else if(s=this.rules.autolink.exec(e))e=e.substring(s[0].length),"@"===s[2]?(i=this.mangle(":"===s[1].charAt(6)?s[1].substring(7):s[1]),a=this.mangle("mailto:")+i):(i=o(s[1]),a=i),n+=this.renderer.link(a,null,i);else if(this.inLink||!(s=this.rules.url.exec(e))){if(s=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(s[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(s[0])&&(this.inLink=!1),e=e.substring(s[0].length),n+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(s[0]):o(s[0]):s[0];else if(s=this.rules.link.exec(e))e=e.substring(s[0].length),this.inLink=!0,n+=this.outputLink(s,{href:s[2],title:s[3]}),this.inLink=!1;else if((s=this.rules.reflink.exec(e))||(s=this.rules.nolink.exec(e))){if(e=e.substring(s[0].length),t=(s[2]||s[1]).replace(/\s+/g," "),t=this.links[t.toLowerCase()],!t||!t.href){n+=s[0].charAt(0),e=s[0].substring(1)+e;continue}this.inLink=!0,n+=this.outputLink(s,t),this.inLink=!1}else if(s=this.rules.strong.exec(e))e=e.substring(s[0].length),n+=this.renderer.strong(this.output(s[2]||s[1]));else if(s=this.rules.em.exec(e))e=e.substring(s[0].length),n+=this.renderer.em(this.output(s[2]||s[1]));else if(s=this.rules.code.exec(e))e=e.substring(s[0].length),n+=this.renderer.codespan(o(s[2],!0));else if(s=this.rules.br.exec(e))e=e.substring(s[0].length),n+=this.renderer.br();else if(s=this.rules.del.exec(e))e=e.substring(s[0].length),n+=this.renderer.del(this.output(s[1]));else if(s=this.rules.text.exec(e))e=e.substring(s[0].length),n+=this.renderer.text(o(this.smartypants(s[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else e=e.substring(s[0].length),i=o(s[1]),a=i,n+=this.renderer.link(a,null,i);return n},i.prototype.outputLink=function(e,t){var i=o(t.href),a=t.title?o(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(i,a,this.output(e[1])):this.renderer.image(i,a,o(e[1]))},i.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014\/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014\/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},i.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,i="",a=e.length,s=0;a>s;s++)t=e.charCodeAt(s),Math.random()>.5&&(t="x"+t.toString(16)),i+="&#"+t+";";return i},a.prototype.code=function(e,t,i){if(this.options.highlight){var a=this.options.highlight(e,t);null!=a&&a!==e&&(i=!0,e=a)}return t?'<pre><code class="'+this.options.langPrefix+o(t,!0)+'">'+(i?e:o(e,!0))+"\n</code></pre>\n":"<pre><code>"+(i?e:o(e,!0))+"\n</code></pre>"},a.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},a.prototype.html=function(e){return e},a.prototype.heading=function(e,t,i){return"<h"+t+' id="'+this.options.headerPrefix+i.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},a.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},a.prototype.list=function(e,t){var i=t?"ol":"ul";return"<"+i+">\n"+e+"</"+i+">\n"},a.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},a.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},a.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},a.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},a.prototype.tablecell=function(e,t){var i=t.header?"th":"td",a=t.align?"<"+i+' style="text-align:'+t.align+'">':"<"+i+">";return a+e+"</"+i+">\n"},a.prototype.strong=function(e){return"<strong>"+e+"</strong>"},a.prototype.em=function(e){return"<em>"+e+"</em>"},a.prototype.codespan=function(e){return"<code>"+e+"</code>"},a.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},a.prototype.del=function(e){return"<del>"+e+"</del>"},a.prototype.link=function(e,t,i){if(this.options.sanitize){try{var a=decodeURIComponent(n(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(s){return""}if(0===a.indexOf("javascript:")||0===a.indexOf("vbscript:")||0===a.indexOf("data:"))return""}var o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+=">"+i+"</a>"},a.prototype.image=function(e,t,i){var a='<img src="'+e+'" alt="'+i+'"';return t&&(a+=' title="'+t+'"'),a+=this.options.xhtml?"/>":">"},a.prototype.text=function(e){return e},s.parse=function(e,t,i){var a=new s(t,i);return a.parse(e)},s.prototype.parse=function(e){this.inline=new i(e.links,this.options,this.renderer),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},s.prototype.next=function(){return this.token=this.tokens.pop()},s.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},s.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},s.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,i,a,s,o="",n="";for(i="",e=0;e<this.token.header.length;e++)a={header:!0,align:this.token.align[e]},i+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(o+=this.renderer.tablerow(i),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],i="",s=0;s<t.length;s++)i+=this.renderer.tablecell(this.inline.output(t[s]),{header:!1,align:this.token.align[s]});n+=this.renderer.tablerow(i)}return this.renderer.table(o,n);case"blockquote_start":for(var n="";"blockquote_end"!==this.next().type;)n+=this.tok();return this.renderer.blockquote(n);case"list_start":for(var n="",r=this.token.ordered;"list_end"!==this.next().type;)n+=this.tok();return this.renderer.list(n,r);case"list_item_start":for(var n="";"list_item_end"!==this.next().type;)n+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(n);case"loose_item_start":for(var n="";"list_item_end"!==this.next().type;)n+=this.tok();return this.renderer.listitem(n);case"html":var d=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(d);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},d.exec=d,c.options=c.setOptions=function(e){return l(c.defaults,e),c},c.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new a,xhtml:!1},c.Parser=s,c.parser=s.parse,c.Renderer=a,c.Lexer=t,c.lexer=t.lex,c.InlineLexer=i,c.inlineLexer=i.output,c.parse=c,e.exports=c}).call(function(){return this||("undefined"!=typeof window?window:t)}())}).call(t,function(){return this}())},function(e,t){$.extend({miCountdown:function(e){var t={startTime:"",endTime:"",timer:"",upTime:!1,onTime:$.noop,onStart:$.noop,onEnd:$.noop},i=$.extend(t,e);if(i.startTime&&i.endTime){var a=$.isNumeric(i.startTime)?i.startTime:new Date(i.startTime).getTime()/1e3,s=$.isNumeric(i.endTime)?i.endTime:new Date(i.endTime).getTime()/1e3;return window.diffTime=window.diffTime||0,window.checkTime=function(){var e=parseInt((new Date).getTime()/1e3)+window.diffTime;if(window.surplusTime=a-e,window.miCountdownTimer&&clearTimeout(window.miCountdownTimer),i.upTime){if(e>=a&&s>e)"function"==typeof i.onStart&&i.onStart(s-e);else if(e>=s){if("function"==typeof i.onEnd)return void i.onEnd(e)}else i.onTime(window.surplusTime);window.miCountdownTimer=setTimeout(function(){window.checkTime()},1e3)}else e>=a&&s>e?"function"==typeof i.onStart&&i.onStart(e):e>=s?"function"==typeof i.onEnd&&i.onEnd(e):(i.onTime(window.surplusTime),window.miCountdownTimer=setTimeout(function(){e+=1,window.checkTime()},1e3))},window.servertime?void window.checkTime():void $.ajax({url:"//time.hd.mi.com/gettimestamp",dataType:"script",cache:!0,timeout:1e4,error:function(){window.servertime=parseInt((new Date).getTime()/1e3),window.checkTime()},success:function(){window.servertime&&"number"==typeof window.servertime?(window.servertime=window.servertime,window.diffTime=window.servertime-parseInt((new Date).getTime()/1e3)||0):window.servertime=parseInt((new Date).getTime()/1e3),window.checkTime()}})}}})},function(e,t){$.extend({miCountdown_seckill:function(e){var t={startTime:"",endTime:"",timer:"",upTime:!1,onTime:$.noop,onStart:$.noop,onEnd:$.noop},i=$.extend(t,e);if(i.startTime&&i.endTime){var a=$.isNumeric(i.startTime)?i.startTime:new Date(i.startTime).getTime()/1e3,s=$.isNumeric(i.endTime)?i.endTime:new Date(i.endTime).getTime()/1e3;return window.diffTime_seckill=window.diffTime_seckill||0,window.checkTime_seckill=function(){var e=parseInt((new Date).getTime()/1e3)+window.diffTime_seckill;if(window.surplusTime_seckill=a-e,window.miCountdownTimer_seckill&&clearTimeout(window.miCountdownTimer_seckill),i.upTime){if(e>=a&&s>e)"function"==typeof i.onStart&&i.onStart(s-e);else if(e>=s){if("function"==typeof i.onEnd)return void i.onEnd(e)}else i.onTime(window.surplusTime_seckill);window.miCountdownTimer_seckill=setTimeout(function(){window.checkTime_seckill()},1e3)}else e>=a&&s>e?"function"==typeof i.onStart&&i.onStart(e):e>=s?"function"==typeof i.onEnd&&i.onEnd(e):(i.onTime(window.surplusTime_seckill),window.miCountdownTimer_seckill=setTimeout(function(){e+=1,window.checkTime_seckill()},1e3))},window.servertime?void window.checkTime_seckill():void $.ajax({url:"//time.hd.mi.com/gettimestamp",dataType:"script",cache:!0,timeout:1e4,error:function(){window.servertime=parseInt((new Date).getTime()/1e3),window.checkTime_seckill()},success:function(){window.servertime&&"number"==typeof window.servertime?(window.servertime=window.servertime,window.diffTime_seckill=window.servertime-parseInt((new Date).getTime()/1e3)||0):window.servertime=parseInt((new Date).getTime()/1e3),window.checkTime_seckill()}})}}})},function(e,t,i){i(7),MI.namespace("buyChooseAddress"),MI.buyChooseAddress={init:function(e){var t=this,i={isShowStreet:!0,showTrigger:"#J_switchChooseRegions",afterChoose:$.noop};t.options=$.extend(i,e),t.apiUrl={my:MI.GLOBAL_CONFIG.orderSite+"/address/getAddressList","default":MI.GLOBAL_CONFIG.orderSite+"/address/getDefaultAddress",search:MI.GLOBAL_CONFIG.orderSite+"/address/searchByKeywords",translate:MI.GLOBAL_CONFIG.orderSite+"/address/getAreaInfoByLocation",save:MI.GLOBAL_CONFIG.orderSite+"/address/setDefaultAddress",login:MI.GLOBAL_CONFIG.orderSite+"/site/login?redirectUrl="+location.href},t.$userDefault=$("#J_userDefaultAddress"),t.$input=$("#J_searchRegionsInput"),t.$inputClear=$("#J_searchRegionsInputClear"),t.$searchWrapper=$("#J_searchAddressWrapper"),t.$loading=t.$searchWrapper.find(".loading"),t.$myAddr=t.$searchWrapper.find("#J_myAddress"),t.$myAddrList=t.$myAddr.find(".list"),t.$noLogin=t.$myAddr.find("#J_noLogin"),t.$nearbyAddr=t.$searchWrapper.find("#J_nearbyAddress"),t.$nearbyAddrList=t.$nearbyAddr.find(".list"),t.$searchAddr=t.$searchWrapper.find("#J_searchAdress"),t.$searchAddrList=t.$searchAddr.find(".list"),t.$noResult=t.$searchWrapper.find("#J_noSearchResult"),t.searchVal=null,t.nearbyData=null,t.myData=null,t.$noLogin.find("a").attr("href",t.apiUrl.login),t.selectAddress=new MI.fourAddress,t.selectAddress.init({selectEnd:function(e){t.formatChooseResult(e)}}),t.checkLogin(),t.searchEvent(),t.selectEvent(),t.switchType(),t.getDefaultAddress(),t.showChooseRegions()},showChooseRegions:function(){var e=this,t=$("#J_modalChooseRegions");$(e.options.showTrigger).on("click",function(){var i=e.$userDefault.offset();$(window).scrollTop()+$(window).height()<i.top+t.height()&&(i.top-=t.height(),i.top+=$("#J_userDefaultAddress").height()),t.css({top:i.top,left:i.left}).modal("show").one("hidden",function(){e.revert()}),e.getMyAddress()})},checkLogin:function(){this.isLogin=$.cookie("cUserId")?!0:!1},revert:function(){this.$input.val(""),this.searchVal=null,this.toggleShow(this.$myAddr,!0),this.toggleShow(this.$nearbyAddr,!1),this.toggleShow(this.$searchAddr,!1),this.toggleShow(this.$noResult,!1)},searchEvent:function(){var e,t,i=this,a=200;i.$input.on({focus:function(){i.toggleShow(i.$myAddr,!1),i.toggleShow(i.$loading,!0),i.searchVal?i.searchAddress():i.nearbyData?i.formatAddress(i.nearbyData,null,"nearby"):i.searchAddress()},blur:function(){t&&clearTimeout(t),t=setTimeout(function(){i.toggleShow(i.$nearbyAddr,!1),i.toggleShow(i.$searchAddr,!1),i.toggleShow(i.$noResult,!1),i.toggleShow(i.$myAddr,!0),$(".J_switchTypeTrigger").eq(0).show()},200)},keyup:function(){e&&clearTimeout(e),e=setTimeout(function(){i.searchVal=$.trim(i.$input.val().replace(/[\-_'=+|\\\/]/g," ")),i.searchVal?i.toggleShow(i.$inputClear,!0):i.toggleShow(i.$inputClear,!1),i.toggleShow(i.$myAddr,!1),i.toggleShow(i.$nearbyAddr,!1),i.toggleShow(i.$searchAddr,!1),i.toggleShow(i.$noResult,!1),i.toggleShow(i.$loading,!0),i.searchAddress()},a)}}),i.$inputClear.on("click",function(){i.searchVal=null,i.$input.val("").focus(),i.toggleShow(i.$inputClear,!1)})},selectEvent:function(){var e=this;e.$myAddrList.on("click",".J_addrItem",function(){var t=$(this).index();e.myData[t].address_id={id:$(this).data("id")},delete e.myData[t].consignee,e.formatChooseResult(e.myData[t])}),$.each([e.$nearbyAddrList,e.$searchAddrList],function(t,i){i.on("click",".J_addrItem",function(){var t=$(this).attr("data-code"),i=$(this).attr("data-location");e.translateSearchResult({code:t,location:i})})})},toggleShow:function(e,t){t?e.removeClass("hide"):e.addClass("hide")},switchType:function(){$(".J_switchTypeTrigger").on("click",function(){var e=$(this).attr("data-type");e&&$(".J_chooseRegionsBox[data-type="+e+"]").removeClass("hide").siblings(".J_chooseRegionsBox").addClass("hide")})},getDefaultAddress:function(){var e=this,t={url:e.apiUrl["default"],dataType:"jsonp",jsonp:"jsonpcallback",timeout:3e4,cache:!0,error:function(){},success:function(t){t&&1===t.code&&e.formatChooseResult(t.data,!0)}};window.ref_goods&&(t.data={},t.data.ref_goods=window.ref_goods),$.ajax(t)},getMyAddress:function(){var e=this;return e.isLogin?void(e.myData||$.ajax({url:e.apiUrl.my,dataType:"jsonp",jsonp:"jsonpcallback",timeout:3e4,cache:!0,error:function(){},success:function(t){t&&1===t.code?(e.myData=t.data,e.formatAddress(t.data,e.myAddressPage,"my")):-2===t.code&&(e.toggleShow(e.$loading,!1),e.toggleShow(e.$myAddr,!0))}})):(e.toggleShow(e.$loading,!1),void e.toggleShow(e.$myAddr,!0))},searchAddress:function(){var e=this,t=e.searchVal?"search":"nearby";$.ajax({url:e.apiUrl.search,dataType:"jsonp",jsonp:"jsonpcallback",data:{keywords:e.searchVal},timeout:3e4,cache:!0,error:function(){},success:function(i){if(i&&1===i.code){if(!i.data||!i.data.length)return e.toggleShow(e.$loading,!1),void("search"===t&&(e.toggleShow(e.$noResult,!0),$(".J_switchTypeTrigger").eq(0).hide()));e.searchVal||(e.nearbyData=i.data),e.formatAddress(i.data.slice(0,5),null,t)}}})},formatAddress:function(e,t,i){if(e){var a=this,s=multiline(function(){/*!@tpl
	        {{~it :value:index}}
	            <li class="J_addrItem" data-id="{{=value.address_id}}">
	                <div class="address-title">
	                    <span class="item">{{=value.consignee}}</span>
	                    <span class="item">{{=value.province.name}}</span>
	                </div>
	                <div class="address-desc">
	                    {{=value.city.name}}{{=value.district.name}}{{=value.area.name}}
	                </div>
	            </li>
	        {{~}}
	        */
console.log()}),o=multiline(function(){/*!@tpl
	        {{~it :value:index}}
	            <li class="J_addrItem" data-code="{{=value.adcode ? value.adcode : ''}}"
	            data-location="{{=value.location}}" data-id="{{=value.address_id}}">
	                <div class="address-title">
	                    <span class="item">{{=value.name}}</span>
	                </div>
	                <div class="address-desc">
	                    {{=value.pname}}{{=value.cityname}}{{=value.adname}}
	                </div>
	                <a class="btn btn-primary">选择</a>
	            </li>
	        {{~}}
	        */
console.log()}),n="";a.toggleShow(a.$loading,!1),a.toggleShow(a.$myAddr,!1),a.toggleShow(a.$noResult,!1),i&&"my"===i?(n=doT.template(s)(e),a.$myAddrList.html(n),a.toggleShow(a.$noLogin,!1),a.toggleShow(a.$myAddr,!0)):"nearby"===i?(n=doT.template(o)(e),a.$nearbyAddrList.html(n),a.toggleShow(a.$nearbyAddr,!0)):"search"===i&&(n=doT.template(o)(e),a.$searchAddrList.html(n),a.toggleShow(a.$searchAddr,!0)),"function"==typeof t&&$.proxy(t,a)()}},myAddressPage:function(){function e(){s.$myAddrList.css({"margin-top":h*(l-1)*-1+"px"}),a.text(l)}var t,i,a,s=this,o=s.$myAddrList.find(".J_addrItem"),n=o.length,r=4,d=n%r>0?parseInt(n/r)+1:n/r,l=1,c=multiline(function(){/*!@tpl
	          <div class="page-controller">
	              <a href="javascript:void(0);" class="iconfont page-prev">&#xe629;</a>
	              <span class="page-num"><i class="curr">{{=it.curr}}</i> / <i class="total">{{=it.total}}</i></span>
	              <a href="javascript:void(0);" class="iconfont page-next">&#xe624;</a>
	          </div>
	        */
console.log()}),p="",h=2*o.outerHeight();1>=d||(s.$myAddrList.parent().css({height:h,overflow:"hidden"}),p=doT.template(c)({curr:l,total:d}),s.$myAddr.append(p),a=s.$myAddr.find(".curr"),i=s.$myAddr.find(".page-next"),t=s.$myAddr.find(".page-prev"),t.on("click",function(){l>1&&(l-=1),e()}),i.on("click",function(){d>l&&(l+=1),e()}))},translateSearchResult:function(e){var t=this;$.ajax({url:t.apiUrl.translate,dataType:"jsonp",jsonp:"jsonpcallback",data:{adcode:e.code,location:e.location},timeout:3e4,error:function(){},success:function(e){e&&1===e.code&&t.formatChooseResult(e.data)}})},isjson:function(e){return"object"!=typeof e||"[object object]"!==Object.prototype.toString.call(e).toLowerCase()||e.length?!1:!0},formatChooseResult:function(e,t){var i=this,a="",s=[],o="";$.each(e,function(e,t){"mihome_id"===e?(o=t,i.options.mihomeId=t):"address_id"===e?s.push({id:t.id}):i.isjson(t)&&s.push({id:t.id,name:t.name})}),t||i.saveResult(s),$.each(s,function(e,t){!i.options.isShowStreet&&e>=4||t.name&&(a+='<span class="item">'+t.name+"</span>")}),i.$userDefault.removeClass("hide").find(".address-info").html(a),"function"==typeof i.options.afterChoose&&i.options.afterChoose(s,o)},saveResult:function(e){var t=this,i={};i=e.length>4?{address_id:{id:e[0].id||""},province:{id:e[1].id,name:e[1].name},city:{id:e[2].id,name:e[2].name},district:{id:e[3].id,name:e[3].name},area:{id:e[4].id,name:e[4].name}}:{province:{id:e[0].id,name:e[0].name},city:{id:e[1].id,name:e[1].name},district:{id:e[2].id,name:e[2].name},area:{id:e[3].id,name:e[3].name}},$.ajax({url:t.apiUrl.save,dataType:"jsonp",jsonp:"jsonpcallback",data:{address:i},timeout:3e4,error:function(){},success:function(){}})}}},function(e,t){MI.namespace("fourAddress"),MI.fourAddress=function(){this.options={wrapperElm:"#J_selectAddressWrapper",optionsWrapper:".J_optionsWrapper",selectWrapper:"#J_selectWrapper",maxLevel:4,afterFormat:$.noop,selectEnd:$.noop}},MI.fourAddress.prototype={constructor:MI.fourAddress,init:function(e){var t=this;"object"==typeof e&&(t.options=$.extend(t.options,e)),t.$wrapper=$(t.options.wrapperElm),t.$wrapper.length&&(t.addrUrl="//s1.mi.com/open/common/js/address_all_new.js?v=7930814",t.addressData=[],t.addrTemp=multiline(function(){/*!@tpl
	          <div class="select-box clearfix" id="J_selectWrapper">
	              <div class="select-first select-item J_select" data-init-txt="选择省份/自治区">选择省份/自治区</div>
	              <div class="select-item J_select hide" data-init-txt="选择城市/地区"></div>
	              <div class="select-item J_select hide" data-init-txt="选择区县"></div>
	              <div class="select-last select-item J_select hide" data-init-txt="选择配送区域"></div>
	          </div>

	          <div class="options-box">
	              <ul class="options-list J_optionsWrapper clearfix">
	                  {{~it :value:index}}
	                      <li class="option J_option"
	                      data-value="{{=value.id}}"
	                      data-txt="{{=value.name}}">{{=value.name}}
	                      </li>
	                  {{~}}
	              </ul>
	              <ul class="options-list J_optionsWrapper clearfix hide"></ul>
	              <ul class="options-list J_optionsWrapper clearfix hide"></ul>
	              <ul class="options-list J_optionsWrapper clearfix hide"></ul>
	          </div>
	        */
console.log()}),t.optionTemp=multiline(function(){/*!@tpl
	          {{~it :value:index}}
	            {{? value.region_id}}
	            <li class="J_option" data-txt="{{=value.region_name}}" data-value="{{=value.region_id}}">
	            {{=value.region_name}}</li>
	            {{?? }}
	            <li class="J_option" data-txt="{{=value.name}}" data-value="{{=value.id}}"
	            data-zipcode="{{=value.zipcode ? value.zipcode : ''}}">{{=value.name}}</li>
	            {{? }}
	          {{~}}
	        */
console.log()}),t.result={},t.lastLevel=t.options.maxLevel-1,t.getAllRegions())},getAllRegions:function(){var e=this;$.ajax({url:e.addrUrl,dataType:"script",cache:!0,timeout:3e4,error:function(){},success:function(){"undefined"!=typeof window.data&&(e.addressData=window.data),e.formatRegions()}})},formatRegions:function(){var e=this,t=doT.template(e.addrTemp),i=t(e.addressData);e.$wrapper.html(i),e.$optionsWrapper=e.$wrapper.find(e.options.optionsWrapper),e.$selectWrapper=e.$wrapper.find(e.options.selectWrapper),e.selectEvent(),"function"==typeof e.options.afterFormat&&e.options.afterFormat()},selectEvent:function(){var e=this,t=0;e.$selectWrapper.on("click.seladdr",".J_select",function(){var i=$(this).addClass("active"),a=$(this).attr("data-init-txt");i&&(t=$(this).index(),e.$selectWrapper.find(".J_select:gt("+t+")").addClass("hide").removeClass("active"),e.$optionsWrapper.addClass("hide").eq(t).removeClass("hide"),$(this).html(a).removeClass("active"))}),e.$optionsWrapper.on("click.seladdr",".J_option",function(){var i=parseInt($(this).attr("data-value")),a=$(this).attr("data-txt"),s=$(this).attr("data-zipcode")||"",o=t+1,n=e.$selectWrapper.find(".J_select").eq(o);return e.result[t]={id:i,name:a,zcode:s},e.$selectWrapper.find(".J_select").eq(t).html(a).addClass("active"),t===e.lastLevel?void("function"==typeof e.options.selectEnd&&e.options.selectEnd(e.result)):(t+=1,o>=e.lastLevel?e.getLastLevelData():e.formatNextLevelOption(i,o),void(n.length&&n.html(n.attr("data-init-txt")).removeClass("hide")))})},getAddressLevelData:function(e){var t=[],i=this;return $.each(i.addressData,function(i,a){return a.id===e?(t=a.child,!1):void(a.child&&$.each(a.child,function(i,a){return a.id===e?(t=a.child,!1):void(a.child&&$.each(a.child,function(i,a){return a.id===e?(t=a.tags,!1):void 0}))}))}),t},formatNextLevelOption:function(e,t){if(e){var i=this,a=i.getAddressLevelData(e,t),s=i.formatOption(a);i.$optionsWrapper.addClass("hide").eq(t).html(s).removeClass("hide"),1===a.length&&setTimeout(function(){i.$optionsWrapper.eq(t).find(".J_option").eq(0).trigger("click")},50)}},getLastLevelData:function(){var e=this,t=MI.GLOBAL_CONFIG.orderSite+"/api/getAddressRegion.php";e.$optionsWrapper.addClass("hide").eq(e.lastLevel).html('<div class="loading"><div class="loader"></div></div>').removeClass("hide"),$.ajax({url:t,dataType:"jsonp",jsonp:"jsonpcallback",data:{parent:e.result[2].id},tiemout:3e4,error:function(){},success:function(t){if(t&&t.data.regions){var i=[];$.each(t.data.regions,function(e,t){i.push(t)});var a=e.formatOption(i);e.$optionsWrapper.eq(e.lastLevel).html(a)}}})},formatOption:function(e){var t=this,i="";return e?i=doT.template(t.optionTemp)(e):void 0},getResult:function(){return this.result}}},function(e,t,i){MI.alert=function(e){var t,a,s={msg:"温馨提示",isConfirm:!1,onCancel:$.noop,onConfirm:$.noop},o=$.extend(s,e),n=i(9),r=$("#J_miAlert");o.msg&&(r.length||($("body").append(n),r=$("#J_miAlert")),t=r.find("#J_miAlertCancel"),a=r.find("#J_miAlertConfirm"),o.isConfirm?("function"==typeof o.onCancel&&t.on("click",o.onCancel),"function"==typeof o.onConfirm&&a.on("click",o.onConfirm)):t.remove(),r.find("#J_miAlertMsg").html(o.msg),r.modal("show"))}},function(e,t){e.exports=function(e){var t='<div class="modal fade modal-hide  modal-alert" id="J_miAlert" > <a class="close" data-dismiss="modal"  href="javascript: void(0);"><i class="iconfont">&#xe602;</i></a> <div class="modal-bd"> <div class="text"> <h3 id="J_miAlertMsg"></h3> </div> <div class="actions"> <button class="btn btn-gray" data-dismiss="modal" id="J_miAlertCancel">取消</button> <button class="btn btn-primary"  data-dismiss="modal" id="J_miAlertConfirm">确定</button> </div> </div></div>';return t}},function(e,t){!function(e){var t={},a={mode:"horizontal",slideSelector:"",infiniteLoop:!0,hideControlOnEnd:!1,speed:500,easing:null,slideMargin:0,startSlide:0,randomStart:!1,captions:!1,ticker:!1,tickerHover:!1,adaptiveHeight:!1,adaptiveHeightSpeed:500,video:!1,useCSS:!0,preloadImages:"visible",responsive:!0,slideZIndex:50,wrapperClass:"ui-wrapper",touchEnabled:!0,swipeThreshold:50,oneToOneTouch:!0,preventDefaultSwipeX:!0,preventDefaultSwipeY:!1,pager:!0,pagerType:"full",pagerShortSeparator:" / ",pagerSelector:null,buildPager:null,pagerCustom:null,controls:!0,nextText:"下一张",prevText:"上一张",nextSelector:null,prevSelector:null,autoControls:!1,startText:"开始",stopText:"停止",autoControlsCombine:!1,autoControlsSelector:null,auto:!1,pause:4e3,autoStart:!0,autoDirection:"next",autoHover:!1,autoDelay:0,autoSlideForOnePage:!1,minSlides:1,maxSlides:1,moveSlides:0,slideWidth:0,onSliderLoad:e.noop,onSlideBefore:e.noop,onSlideAfter:e.noop,onSlideNext:e.noop,onSlidePrev:e.noop,onSliderResize:e.noop};e.fn.slider=function(s){if(0==this.length)return this;if(this.length>1)return this.each(function(){e(this).slider(s)}),this;var o={},n=this;t.el=this;var r=e(window).width(),d=e(window).height(),l=function(){o.settings=e.extend({},a,s),o.settings.slideWidth=parseInt(o.settings.slideWidth),o.children=n.children(o.settings.slideSelector),o.children.length<o.settings.minSlides&&(o.settings.minSlides=o.children.length),o.children.length<o.settings.maxSlides&&(o.settings.maxSlides=o.children.length),o.settings.randomStart&&(o.settings.startSlide=Math.floor(Math.random()*o.children.length)),o.active={index:o.settings.startSlide},o.carousel=o.settings.minSlides>1||o.settings.maxSlides>1,o.carousel&&(o.settings.preloadImages="all"),o.minThreshold=o.settings.minSlides*o.settings.slideWidth+(o.settings.minSlides-1)*o.settings.slideMargin,o.maxThreshold=o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin,o.working=!1,o.controls={},o.interval=null,o.animProp="vertical"==o.settings.mode?"top":"left",o.usingCSS=o.settings.useCSS&&"fade"!=o.settings.mode&&function(){var e=document.createElement("div"),t=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var i in t)if(void 0!==e.style[t[i]])return o.cssPrefix=t[i].replace("Perspective","").toLowerCase(),o.animProp="-"+o.cssPrefix+"-transform",!0;return!1}(),"vertical"==o.settings.mode&&(o.settings.maxSlides=o.settings.minSlides),n.data("origStyle",n.attr("style")),n.children(o.settings.slideSelector).each(function(){e(this).data("origStyle",e(this).attr("style"))}),c()},c=function(){n.wrap('<div class="'+o.settings.wrapperClass+'"><div class="ui-viewport"></div></div>'),o.viewport=n.parent(),o.loader=e('<div class="ui-loading" />'),o.viewport.prepend(o.loader),n.css({width:"horizontal"==o.settings.mode?100*o.children.length+215+"%":"auto",position:"relative"}),o.usingCSS&&o.settings.easing?n.css("-"+o.cssPrefix+"-transition-timing-function",o.settings.easing):o.settings.easing||(o.settings.easing="swing");m();o.viewport.css({width:"100%",overflow:"hidden",position:"relative"}),o.viewport.parent().css({maxWidth:g()}),o.settings.pager||o.viewport.parent().css({margin:"0 auto 0px"}),o.children.css({"float":"horizontal"==o.settings.mode?"left":"none",listStyle:"none",position:"relative"}),o.children.css("width",f()),"horizontal"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginRight",o.settings.slideMargin),"vertical"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginBottom",o.settings.slideMargin),"fade"==o.settings.mode&&(o.children.css({position:"absolute",zIndex:0,display:"none"}),o.children.eq(o.settings.startSlide).css({zIndex:o.settings.slideZIndex,display:"block"})),o.controls.el=e('<div class="ui-controls" />'),o.settings.captions&&C(),o.active.last=o.settings.startSlide==v()-1,o.settings.video&&n.fitVids();var t=o.children.eq(o.settings.startSlide);"all"==o.settings.preloadImages&&(t=o.children),o.settings.ticker?o.settings.pager=!1:(o.settings.pager&&x(),o.settings.controls&&$(),o.settings.auto&&o.settings.autoControls&&w(),(o.settings.controls||o.settings.autoControls||o.settings.pager)&&o.viewport.after(o.controls.el)),p(t,h)},p=function(t,i){var a=t.find("img, iframe").length;if(0==a)return void i();var s=0;t.find("img, iframe").each(function(){e(this).one("load",function(){++s==a&&i()}).each(function(){this.complete&&e(this).load()})})},h=function(){if(o.settings.infiniteLoop&&"fade"!=o.settings.mode&&!o.settings.ticker){var t="vertical"==o.settings.mode?o.settings.minSlides:o.settings.maxSlides,i=o.children.slice(0,t).clone().addClass("ui-clone"),a=o.children.slice(-t).clone().addClass("ui-clone");n.append(i).prepend(a)}o.loader.remove(),b(),"vertical"==o.settings.mode&&(o.settings.adaptiveHeight=!0),o.viewport.height(u()),n.redrawSlider(),o.settings.onSliderLoad(o.active.index),o.initialized=!0,o.settings.responsive&&e(window).bind("resize",R),o.settings.auto&&o.settings.autoStart&&(v()>1||o.settings.autoSlideForOnePage)&&j(),o.settings.ticker&&P(),o.settings.pager&&B(o.settings.startSlide),o.settings.controls&&M(),o.settings.touchEnabled&&!o.settings.ticker&&O()},u=function(){var t=0,a=e();if("vertical"==o.settings.mode||o.settings.adaptiveHeight)if(o.carousel){var s=1==o.settings.moveSlides?o.active.index:o.active.index*_();for(a=o.children.eq(s),i=1;i<=o.settings.maxSlides-1;i++)a=a.add(s+i>=o.children.length?o.children.eq(i-1):o.children.eq(s+i))}else a=o.children.eq(o.active.index);else a=o.children;return"vertical"==o.settings.mode?(a.each(function(i){t+=e(this).outerHeight()}),o.settings.slideMargin>0&&(t+=o.settings.slideMargin*(o.settings.minSlides-1))):t=Math.max.apply(Math,a.map(function(){return e(this).outerHeight(!1)}).get()),"border-box"==o.viewport.css("box-sizing")?t+=parseFloat(o.viewport.css("padding-top"))+parseFloat(o.viewport.css("padding-bottom"))+parseFloat(o.viewport.css("border-top-width"))+parseFloat(o.viewport.css("border-bottom-width")):"padding-box"==o.viewport.css("box-sizing")&&(t+=parseFloat(o.viewport.css("padding-top"))+parseFloat(o.viewport.css("padding-bottom"))),t},g=function(){var e="100%";return o.settings.slideWidth>0&&(e="horizontal"==o.settings.mode?o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin:o.settings.slideWidth),e},f=function(){var e=o.settings.slideWidth,t=o.viewport.width();return 0==o.settings.slideWidth||o.settings.slideWidth>t&&!o.carousel||"vertical"==o.settings.mode?e=t:o.settings.maxSlides>1&&"horizontal"==o.settings.mode&&(t>o.maxThreshold||t<o.minThreshold&&(e=(t-o.settings.slideMargin*(o.settings.minSlides-1))/o.settings.minSlides)),e},m=function(){var e=1;if("horizontal"==o.settings.mode&&o.settings.slideWidth>0)if(o.viewport.width()<o.minThreshold)e=o.settings.minSlides;else if(o.viewport.width()>o.maxThreshold)e=o.settings.maxSlides;else{var t=o.children.first().width()+o.settings.slideMargin;e=Math.floor((o.viewport.width()+o.settings.slideMargin)/t)}else"vertical"==o.settings.mode&&(e=o.settings.minSlides);return e},v=function(){var e=0;if(o.settings.moveSlides>0)if(o.settings.infiniteLoop)e=Math.ceil(o.children.length/_());else for(var t=0,i=0;t<o.children.length;)++e,t=i+m(),i+=o.settings.moveSlides<=m()?o.settings.moveSlides:m();else e=Math.ceil(o.children.length/m());return e},_=function(){return o.settings.moveSlides>0&&o.settings.moveSlides<=m()?o.settings.moveSlides:m()},b=function(){if(o.children.length>o.settings.maxSlides&&o.active.last&&!o.settings.infiniteLoop){if("horizontal"==o.settings.mode){var e=o.children.last(),t=e.position();y(-(t.left-(o.viewport.width()-e.outerWidth())),"reset",0)}else if("vertical"==o.settings.mode){var i=o.children.length-o.settings.minSlides,t=o.children.eq(i).position();y(-t.top,"reset",0)}}else{var t=o.children.eq(o.active.index*_()).position();o.active.index==v()-1&&(o.active.last=!0),void 0!=t&&("horizontal"==o.settings.mode?y(-t.left,"reset",0):"vertical"==o.settings.mode&&y(-t.top,"reset",0))}},y=function(e,t,i,a){if(o.usingCSS){var s="vertical"==o.settings.mode?"translate3d(0, "+e+"px, 0)":"translate3d("+e+"px, 0, 0)";n.css("-"+o.cssPrefix+"-transition-duration",i/1e3+"s"),"slide"==t?(n.css(o.animProp,s),n.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){n.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),D()})):"reset"==t?n.css(o.animProp,s):"ticker"==t&&(n.css("-"+o.cssPrefix+"-transition-timing-function","linear"),n.css(o.animProp,s),n.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){n.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),y(a.resetValue,"reset",0),F()}))}else{var r={};r[o.animProp]=e,"slide"==t?n.animate(r,i,o.settings.easing,function(){D()}):"reset"==t?n.css(o.animProp,e):"ticker"==t&&n.animate(r,speed,"linear",function(){y(a.resetValue,"reset",0),F()})}},k=function(){for(var t="",i=v(),a=0;i>a;a++){var s="";o.settings.buildPager&&e.isFunction(o.settings.buildPager)?(s=o.settings.buildPager(a),o.pagerEl.addClass("ui-custom-pager")):(s=a+1,o.pagerEl.addClass("ui-default-pager")),t+='<div class="ui-pager-item"><a href="" data-slide-index="'+a+'" class="ui-pager-link">'+s+"</a></div>"}o.pagerEl.html(t)},x=function(){o.settings.pagerCustom?o.pagerEl=e(o.settings.pagerCustom):(o.pagerEl=e('<div class="ui-pager" />'),o.settings.pagerSelector?e(o.settings.pagerSelector).html(o.pagerEl):o.controls.el.addClass("ui-has-pager").append(o.pagerEl),k()),o.pagerEl.on("click","a",I)},$=function(){o.controls.next=e('<a class="ui-next" href="">'+o.settings.nextText+"</a>"),o.controls.prev=e('<a class="ui-prev" href="">'+o.settings.prevText+"</a>"),o.controls.next.bind("click",S),o.controls.prev.bind("click",J),o.settings.nextSelector&&e(o.settings.nextSelector).append(o.controls.next),o.settings.prevSelector&&e(o.settings.prevSelector).append(o.controls.prev),o.settings.nextSelector||o.settings.prevSelector||(o.controls.directionEl=e('<div class="ui-controls-direction" />'),o.controls.directionEl.append(o.controls.prev).append(o.controls.next),o.controls.el.addClass("ui-has-controls-direction").append(o.controls.directionEl))},w=function(){o.controls.start=e('<div class="ui-controls-auto-item"><a class="ui-start" href="">'+o.settings.startText+"</a></div>"),o.controls.stop=e('<div class="ui-controls-auto-item"><a class="ui-stop" href="">'+o.settings.stopText+"</a></div>"),o.controls.autoEl=e('<div class="ui-controls-auto" />'),o.controls.autoEl.on("click",".ui-start",T),o.controls.autoEl.on("click",".ui-stop",A),o.settings.autoControlsCombine?o.controls.autoEl.append(o.controls.start):o.controls.autoEl.append(o.controls.start).append(o.controls.stop),o.settings.autoControlsSelector?e(o.settings.autoControlsSelector).html(o.controls.autoEl):o.controls.el.addClass("ui-has-controls-auto").append(o.controls.autoEl),L(o.settings.autoStart?"stop":"start")},C=function(){o.children.each(function(t){var i=e(this).find("img:first").attr("title");void 0!=i&&(""+i).length&&e(this).append('<div class="ui-caption"><span>'+i+"</span></div>")})},S=function(e){o.settings.auto&&n.stopAuto(),n.goToNextSlide(),e.preventDefault()},J=function(e){o.settings.auto&&n.stopAuto(),n.goToPrevSlide(),e.preventDefault()},T=function(e){n.startAuto(),e.preventDefault()},A=function(e){n.stopAuto(),e.preventDefault()},I=function(t){var i=e(t.currentTarget);if(void 0!==i.attr("data-slide-index")){var a=parseInt(i.attr("data-slide-index"));a!=o.active.index&&(o.settings.auto&&n.stopAuto(),n.goToSlide(a)),t.preventDefault()}},B=function(t){var i=o.children.length;return"short"==o.settings.pagerType?(o.settings.maxSlides>1&&(i=Math.ceil(o.children.length/o.settings.maxSlides)),void o.pagerEl.html(t+1+o.settings.pagerShortSeparator+i)):(o.pagerEl.find("a").removeClass("active"),void o.pagerEl.each(function(i,a){e(a).find("a").eq(t).addClass("active")}))},D=function(){if(o.settings.infiniteLoop){var e="";0==o.active.index?e=o.children.eq(0).position():o.active.index==v()-1&&o.carousel?e=o.children.eq((v()-1)*_()).position():o.active.index==o.children.length-1&&(e=o.children.eq(o.children.length-1).position()),e&&("horizontal"==o.settings.mode?y(-e.left,"reset",0):"vertical"==o.settings.mode&&y(-e.top,"reset",0))}o.working=!1,o.settings.onSlideAfter(o.children.eq(o.active.index),o.oldIndex,o.active.index)},L=function(e){o.settings.autoControlsCombine?o.controls.autoEl.html(o.controls[e]):(o.controls.autoEl.find("a").removeClass("active"),o.controls.autoEl.find("a:not(.ui-"+e+")").addClass("active"))},M=function(){1==v()?(o.controls.prev.addClass("disabled"),o.controls.next.addClass("disabled")):!o.settings.infiniteLoop&&o.settings.hideControlOnEnd&&(0==o.active.index?(o.controls.prev.addClass("disabled"),o.controls.next.removeClass("disabled")):o.active.index==v()-1?(o.controls.next.addClass("disabled"),o.controls.prev.removeClass("disabled")):(o.controls.prev.removeClass("disabled"),o.controls.next.removeClass("disabled")))},j=function(){if(o.settings.autoDelay>0){setTimeout(n.startAuto,o.settings.autoDelay)}else n.startAuto();o.settings.autoHover&&n.hover(function(){o.interval&&(n.stopAuto(!0),o.autoPaused=!0)},function(){o.autoPaused&&(n.startAuto(!0),o.autoPaused=null)})},P=function(){var t=0;if("next"==o.settings.autoDirection)n.append(o.children.clone().addClass("ui-clone"));else{n.prepend(o.children.clone().addClass("ui-clone"));var i=o.children.first().position();t="horizontal"==o.settings.mode?-i.left:-i.top}y(t,"reset",0),o.settings.pager=!1,o.settings.controls=!1,o.settings.autoControls=!1,o.settings.tickerHover&&!o.usingCSS&&o.viewport.hover(function(){n.stop()},function(){var t=0;o.children.each(function(i){t+="horizontal"==o.settings.mode?e(this).outerWidth(!0):e(this).outerHeight(!0)});var i=o.settings.speed/t,a="horizontal"==o.settings.mode?"left":"top",s=i*(t-Math.abs(parseInt(n.css(a))));F(s)}),F()},F=function(e){speed=e?e:o.settings.speed;var t={left:0,top:0},i={left:0,top:0};"next"==o.settings.autoDirection?t=n.find(".ui-clone").first().position():i=o.children.first().position();var a="horizontal"==o.settings.mode?-t.left:-t.top,s="horizontal"==o.settings.mode?-i.left:-i.top,r={resetValue:s};y(a,"ticker",speed,r)},O=function(){o.touch={start:{x:0,y:0},end:{x:0,y:0}},o.viewport.bind("touchstart",N)},N=function(e){if(o.working)e.preventDefault();else{o.touch.originalPos=n.position();var t=e.originalEvent;o.touch.start.x=t.changedTouches[0].pageX,o.touch.start.y=t.changedTouches[0].pageY,o.viewport.bind("touchmove",E),o.viewport.bind("touchend",G)}},E=function(e){var t=e.originalEvent,i=Math.abs(t.changedTouches[0].pageX-o.touch.start.x),a=Math.abs(t.changedTouches[0].pageY-o.touch.start.y);if(3*i>a&&o.settings.preventDefaultSwipeX?e.preventDefault():3*a>i&&o.settings.preventDefaultSwipeY&&e.preventDefault(),"fade"!=o.settings.mode&&o.settings.oneToOneTouch){var s=0;if("horizontal"==o.settings.mode){var n=t.changedTouches[0].pageX-o.touch.start.x;s=o.touch.originalPos.left+n}else{var n=t.changedTouches[0].pageY-o.touch.start.y;s=o.touch.originalPos.top+n}y(s,"reset",0)}},G=function(e){o.viewport.unbind("touchmove",E);var t=e.originalEvent,i=0;if(o.touch.end.x=t.changedTouches[0].pageX,o.touch.end.y=t.changedTouches[0].pageY,"fade"==o.settings.mode){var a=Math.abs(o.touch.start.x-o.touch.end.x);a>=o.settings.swipeThreshold&&(o.touch.start.x>o.touch.end.x?n.goToNextSlide():n.goToPrevSlide(),n.stopAuto())}else{var a=0;"horizontal"==o.settings.mode?(a=o.touch.end.x-o.touch.start.x,i=o.touch.originalPos.left):(a=o.touch.end.y-o.touch.start.y,i=o.touch.originalPos.top),!o.settings.infiniteLoop&&(0==o.active.index&&a>0||o.active.last&&0>a)?y(i,"reset",200):Math.abs(a)>=o.settings.swipeThreshold?(0>a?n.goToNextSlide():n.goToPrevSlide(),n.stopAuto()):y(i,"reset",200)}o.viewport.unbind("touchend",G)},R=function(t){if(o.initialized){var i=e(window).width(),a=e(window).height();(r!=i||d!=a)&&(r=i,d=a,n.redrawSlider(),o.settings.onSliderResize.call(n,o.active.index))}};return n.goToSlide=function(t,i){if(!o.working&&o.active.index!=t){if(o.working=!0,o.oldIndex=o.active.index,o.active.index=0>t?v()-1:t>=v()?0:t,o.settings.onSlideBefore(o.children.eq(o.active.index),o.oldIndex,o.active.index),"next"==i?o.settings.onSlideNext(o.children.eq(o.active.index),o.oldIndex,o.active.index):"prev"==i&&o.settings.onSlidePrev(o.children.eq(o.active.index),o.oldIndex,o.active.index),o.active.last=o.active.index>=v()-1,o.settings.pager&&B(o.active.index),o.settings.controls&&M(),"fade"==o.settings.mode)o.settings.adaptiveHeight&&o.viewport.height()!=u()&&o.viewport.animate({height:u()},o.settings.adaptiveHeightSpeed),o.children.filter(":visible").fadeOut(o.settings.speed).css({zIndex:0}),o.children.eq(o.active.index).css("zIndex",o.settings.slideZIndex+1).fadeIn(o.settings.speed,function(){e(this).css("zIndex",o.settings.slideZIndex),D()});else{o.settings.adaptiveHeight&&o.viewport.height()!=u()&&o.viewport.animate({height:u()},o.settings.adaptiveHeightSpeed);var a=0,s={left:0,top:0};if(!o.settings.infiniteLoop&&o.carousel&&o.active.last)if("horizontal"==o.settings.mode){var r=o.children.eq(o.children.length-1);s=r.position(),a=o.viewport.width()-r.outerWidth()}else{var d=o.children.length-o.settings.minSlides;s=o.children.eq(d).position()}else if(o.carousel&&o.active.last&&"prev"==i){var l=1==o.settings.moveSlides?o.settings.maxSlides-_():(v()-1)*_()-(o.children.length-o.settings.maxSlides),r=n.children(".ui-clone").eq(l);s=r.position()}else if("next"==i&&0==o.active.index)s=n.find("> .ui-clone").eq(o.settings.maxSlides).position(),o.active.last=!1;else if(t>=0){var c=t*_();s=o.children.eq(c).position()}if("undefined"!=typeof s){var p="horizontal"==o.settings.mode?-(s.left-a):-s.top;y(p,"slide",o.settings.speed)}}o.settings.auto&&n.startAuto()}},n.goToNextSlide=function(){if(o.settings.infiniteLoop||!o.active.last){var e=parseInt(o.active.index)+1;n.goToSlide(e,"next")}},n.goToPrevSlide=function(){if(o.settings.infiniteLoop||0!=o.active.index){var e=parseInt(o.active.index)-1;n.goToSlide(e,"prev")}},n.startAuto=function(e){o.interval||(o.interval=setInterval(function(){"next"==o.settings.autoDirection?n.goToNextSlide():n.goToPrevSlide()},o.settings.pause),o.settings.autoControls&&1!=e&&L("stop"))},n.stopAuto=function(e){o.interval&&(clearInterval(o.interval),o.interval=null,o.settings.autoControls&&1!=e&&L("start"))},n.getCurrentSlide=function(){return o.active.index},n.getCurrentSlideElement=function(){return o.children.eq(o.active.index)},n.getSlideCount=function(){return o.children.length},n.redrawSlider=function(){o.children.add(n.find(".ui-clone")).width(f()),o.viewport.css("height",u()),o.settings.ticker||b(),o.active.last&&(o.active.index=v()-1),o.active.index>=v()&&(o.active.last=!0),o.settings.pager&&!o.settings.pagerCustom&&(k(),B(o.active.index))},n.destroySlider=function(){o.initialized&&(o.initialized=!1,e(".ui-clone",this).remove(),o.children.each(function(){void 0!=e(this).data("origStyle")?e(this).attr("style",e(this).data("origStyle")):e(this).removeAttr("style")}),void 0!=e(this).data("origStyle")?this.attr("style",e(this).data("origStyle")):e(this).removeAttr("style"),e(this).unwrap().unwrap(),o.controls.el&&o.controls.el.remove(),o.controls.next&&o.controls.next.remove(),o.controls.prev&&o.controls.prev.remove(),o.pagerEl&&o.settings.controls&&o.pagerEl.remove(),e(".ui-caption",this).remove(),o.controls.autoEl&&o.controls.autoEl.remove(),clearInterval(o.interval),o.settings.responsive&&e(window).unbind("resize",R))},n.reloadSlider=function(e){void 0!=e&&(s=e),n.destroySlider(),l()},l(),this}}(jQuery)},function(e,t,i){var a=i(12),s={goods_addCart:{sku:"",sph_l:"",sph_r:"",pd:"",cyl_l:"",cyl_r:"",axis_l:"",axis_r:"",refractive_index:1.56},goodsInfo:{},refractiveArr:[1.56,1.6,1.67,1.74],chooseIndex:0};MI.glassBuy=function(e,t){function i(){d(),$(".right_sphType").select(function(e){s.goods_addCart.sph_r=e.data("value"),n()},"右眼"),$(".left_sphType").select(function(e){s.goods_addCart.sph_l=e.data("value"),n()},"左眼"),$(".pd_type").select(function(e){s.goods_addCart.pd=e.data("value")},"瞳距 "),$(".right_cyl_Type").select(function(e){s.goods_addCart.cyl_r=e.data("value"),o(),n()},"右眼"),$(".left_cyl_Type").select(function(e){s.goods_addCart.cyl_l=e.data("value"),o(),n()},"左眼"),$(".right_axis_Type").select(function(e){s.goods_addCart.axis_r=e.data("value")},"右眼轴距 "),$(".left_axis_Type").select(function(e){s.goods_addCart.axis_l=e.data("value")},"左眼轴距 ")}function o(){var e=$(".left_axis_Type"),t=$(".right_axis_Type");0===s.goods_addCart.cyl_l?(e.removeClass("err").addClass("disabled"),e.find(".base-select .choose-item").attr("data-value","").text("请选择左眼轴距"),s.goods_addCart.axis_l=""):e.removeClass("disabled"),0===s.goods_addCart.cyl_r?(t.removeClass("err").addClass("disabled"),t.find(".base-select .choose-item").attr("data-value","").text("请选择右眼轴距"),s.goods_addCart.axis_r=""):t.removeClass("disabled")}function n(){{var e=_.checkBigNum(100*Math.abs(s.goods_addCart.sph_r),100*Math.abs(s.goods_addCart.sph_l)).small,t=_.checkBigNum(100*Math.abs(s.goods_addCart.sph_r),100*Math.abs(s.goods_addCart.sph_l)).big;0===s.goods_addCart.cyl_r&&0===s.goods_addCart.cyl_l}if("0.00"===s.goods_addCart.sph_r&&"0.00"===s.goods_addCart.sph_l){var i=$(".pd_type").find(".base-select .choose-item");$(".pd_type").removeClass("err").addClass("disabled"),i.attr("data-value","").text("请选择瞳距"),s.goods_addCart.pd=""}else $(".pd_type").removeClass("disabled");0===t?s.refractiveArr=[1.56,1.6]:200>=t?s.refractiveArr=[1.56,1.6,1.67]:400>=t?s.refractiveArr=[1.6,1.67]:700>=t?s.refractiveArr=200>=e?[1.67]:[1.67,1.74]:1200>=t&&(s.refractiveArr=400>=e?[]:[1.74]),r()}function r(){for(var e=$(".J_refractive_list").find("li"),t=0;t<s.goodsInfo.length;t++){var i=s.goodsInfo[t].refractive_index;$.inArray(i,s.refractiveArr)<0?e.eq(t).addClass("disabled"):e.eq(t).removeClass("disabled")}$.each(e,function(t,i){return $(i).hasClass("disabled")?(s.chooseIndex=-1,void e.removeClass("active")):($(this).addClass("active").siblings().removeClass("active"),s.chooseIndex=t,s.goods_addCart.refractive_index=s.goodsInfo[s.chooseIndex].refractive_index,!1)}),e.off().on("click",function(e){$(this).hasClass("disabled")||$(this).hasClass("active")||($(this).addClass("active").siblings().removeClass("active"),s.chooseIndex=$(this).data("index"),s.goods_addCart.refractive_index=s.goodsInfo[s.chooseIndex].refractive_index,s.goods_addCart.sku=$(this).data("sku"),d(),e.stopPropagation())}),d()}function d(){-1!==s.chooseIndex?($(".J_modalFooterGlassValue").show(),$(".J_modalFooterGlassValue span").text(s.goodsInfo[s.chooseIndex].price),f.removeClass("btn-disabled").text("加入购物车")):($(".J_modalFooterGlassValue").hide(),f.addClass("btn-disabled").text("无可选镜片规格")),-1!==s.chooseIndex&&(s.goods_addCart.sku=s.goodsInfo[s.chooseIndex].sku)}function l(){f.off().on("click",function(e){if(e.stopPropagation(),!$(this).hasClass("btn-disabled")){var t=""===s.goods_addCart.pd&&("0.00"!==s.goods_addCart.sph_r||"0.00"!==s.goods_addCart.sph_l),i=""===s.goods_addCart.axis_r&&0!==s.goods_addCart.cyl_r,a=""===s.goods_addCart.axis_l&&0!==s.goods_addCart.cyl_l;""===s.goods_addCart.sph_l||""===s.goods_addCart.sph_r||""===s.goods_addCart.cyl_l||""===s.goods_addCart.cyl_r||a||i||t?(""===s.goods_addCart.sph_r&&$(".right_sphType").addClass("err"),""===s.goods_addCart.sph_l&&$(".left_sphType").addClass("err"),t&&$(".pd_type").addClass("err"),""===s.goods_addCart.cyl_r&&$(".right_cyl_Type").addClass("err"),""===s.goods_addCart.cyl_l&&$(".left_cyl_Type").addClass("err"),i&&$(".right_axis_Type").addClass("err"),a&&$(".left_axis_Type").addClass("err")):(m.modal("hide"),v.find(".modal-body").html(g(s)),v.modal("show"),c(),p())}})}function c(){$("#J_GlasschooseBack").off().on("click",function(e){m.modal("show"),v.modal("hide"),e.stopPropagation()})}function p(){$("#J_GlassAddCart").off().on("click",function(e){v.modal("hide"),t(s.goods_addCart,s.goodsInfo[s.chooseIndex].goods_id),e.stopPropagation()})}var h=MI.GLOBAL_CONFIG.orderSite+"/glass/getBuyInfo?goods_id="+e,u=doT.template($("#J_glassrefractiveTmp").html()),g=doT.template($("#J_glasscheckOrderTmp").html()),f=$(".J_modalFooterGlassBtn"),m=$("#J_orderModalGlassBuy"),v=$("#J_orderCheckGlassBuy");a.ajax({url:h,timeout:3e3,error:function(e,t){$(".J_load").html("数据异常，请稍后刷新重试")},callback:function(e){if(1===e.code&&0!==e.data.length){var t=e.data;$(".J_load").hide(),$(".modal-info, .modal-footer").show(),s.goodsInfo=t.refractive_index,_.renderArray($("#right_sphType"),t.sph_min,t.sph_max,t.sph_step,"sph"),_.renderArray($("#left_sphType"),t.sph_min,t.sph_max,t.sph_step,"sph"),_.renderArray($("#pd_type"),t.pd_min,t.pd_max,t.pd_step),_.renderArray($("#right_cyl_Type"),t.cyl_min,t.cyl_max,t.cyl_step,"cyl"),_.renderArray($("#left_cyl_Type"),t.cyl_min,t.cyl_max,t.cyl_step,"cyl"),_.renderArray($("#right_axis_Type"),t.axis_min,t.axis_max,t.axis_step),_.renderArray($("#left_axis_Type"),t.axis_min,t.axis_max,t.axis_step),$(".J_refractive_list").html(u(_.refractiveSort(t.refractive_index))),i(),r(),l()}else $(".J_load").html("数据异常，请稍后刷新重试")}});var _={renderArray:function(e,t,i,a,s){var o=[];$(e).html(""),"cyl"===s?(o.indexOf("0")<0&&o.push(0),o=o.concat(this.sortDataArr(this.checkBigNum(t,i).small,this.checkBigNum(t,i).big,a))):o=this.sortDataArr(this.checkBigNum(t,i).small,this.checkBigNum(t,i).big,a);for(var n=0;n<o.length;n++)s?("sph"===s&&(0===o[n]?$('<div class="choose-item" data-value="0.00">平光(0.00)</div>').appendTo($(e)):o[n]<0?$('<div class="choose-item" data-value="'+o[n]+'">近视'+100*Math.abs(o[n])+"度("+o[n].toFixed(2)+"）</div>").appendTo($(e)):$('<div class="choose-item" data-value="'+o[n]+'">远视'+100*Math.abs(o[n])+"度("+o[n].toFixed(2)+"）</div>").appendTo($(e))),"cyl"===s&&(0===o[n]?$('<div class="choose-item" data-value= 0>散光(无)</div>').appendTo($(e)):$('<div class="choose-item" data-value='+o[n]+">散光"+100*Math.abs(o[n])+"度("+o[n].toFixed(2)+"）</div>").appendTo($(e)))):$('<div class="choose-item" data-value='+o[n]+">"+o[n]+"</div>").appendTo($(e))},checkBigNum:function(e,t){return{big:e>t?e:t,small:e>t?t:e}},sortDataArr:function(e,t,i){var a=[];if(i){if(0>=t){for(var s=t;s>=e;s-=i)a.push(s);return a}if(e>=0){for(var s=e;t>=s;s+=i)a.push(s);return a}if(0>e&&t>0){for(var o=[],s=e;0>=s;s+=i)o.push(s);for(var s=t;s>0;s-=i)a.push(s);return o.reverse().concat(a.reverse())}}},refractiveSort:function(e){var t=function(e){return function(t,i){var a=t[e],s=i[e];return isNaN(Number(a))||isNaN(Number(s))||(a=Number(a),s=Number(s)),s>a?-1:a>s?1:0}};return e.sort(t("refractive_index"))}};jQuery.fn.select=function(e,t){return this.each(function(){var i=$(this),a=i.find(".select-list > .choose-item");i.off().on("click",function(e){i.removeClass("err"),i.hasClass("disabled")||($(".select-list").removeClass("show zIndex"),$(this).find(".select-list").addClass("show zIndex")),e.stopPropagation()}),a.off().on("click",function(a){var s=$(this);if(!s.hasClass("active")){var o=s.data("value"),n=t+s.text();i.find(".base-select .choose-item").attr("data-value",o).text(n),i.find(".select-list").removeClass("show zIndex"),e&&"function"==typeof e&&e(s,t)}a.stopPropagation()}),$("body").bind("click",function(e){i.find(".select-list").removeClass("show zIndex"),e.stopPropagation()})})}}},function(e,t){var i={proxy:0,ajax:function(e){var t={type:"GET",url:e.url,dataType:"jsonp",jsonp:"jsonpcallback",data:e.data||"",timeout:1e4,error:function(t,i,a){var s={};e.data&&(s=e.data),s.locationHref=window.location.href,s.errorData=t,s.errorType=i,s.error=a,_msq.push(["trackEvent","AJAX_ERROR",encodeURIComponent(e.url),JSON.stringify(s)]);var o=e.error;o&&o(t)},success:function(t){var i=e.callback;i&&i(t)}};e.jsonpCallback&&(t.jsonpCallback=e.jsonpCallback),$.ajax(t)},setProxy:function(e,t){var a=$('<iframe width="0" height="0" name="ihuodong"></iframe>');a.attr("src",t),$("body").append(a),$('iframe[name="ihuodong"]').load(function(){"function"==typeof e&&e(),$('iframe[name="ihuodong"]').remove(),i.proxy=1})},loadImage:function(e){var t=new Image;return t.src=e.data("src"),t.complete?void e.attr("src",t.src).addClass("done"):void(t.onload=function(){e.attr("src",t.src).addClass("done")})}};e.exports=i},function(e,t){var i={isLogin:$.cookie("cUserId")?!0:!1,elm:$("#J_buyBox"),hdUrl:"//a.huodong.mi.com",
hdloginUrl:"//i.huodong.mi.com/site/login?redirectUrl="+location.href,staticUrl:MI.GLOBAL_CONFIG.staticSite+"/buySuccess/?gid=",orderapi:window.orderapi_host,orderSite:MI.GLOBAL_CONFIG.orderSite||"//order.mi.com",loginUrl:(MI.GLOBAL_CONFIG.orderSite||"//order.mi.com")+"/site/login?redirectUrl="+location.href,orderGet:window.apiorder_host+"/product/get",addAddressUrl:(MI.GLOBAL_CONFIG.orderSite||"//order.mi.com")+"/user/address?redirectUrl="+location.href+"&autoShow=1",addressListUrl:(MI.GLOBAL_CONFIG.orderSite||"//order.mi.com")+"/address/getAddressList",orderSubmitUrl:(MI.GLOBAL_CONFIG.orderSite||"//order.mi.com")+"/buyservice/appointmentCreate",bookRule:(MI.GLOBAL_CONFIG.orderSite||"//order.mi.com")+"/product/bookingRules",couponUrl:(MI.GLOBAL_CONFIG.orderSite||"//order.mi.com")+"/product/getCommodityActs",orderCount:(MI.GLOBAL_CONFIG.orderSite||"//order.mi.com")+"/buyservice/appointmentCount",orderDatacheck:(MI.GLOBAL_CONFIG.orderSite||"//order.mi.com")+"/buyservice/appointmentCheck"};e.exports=i},function(e,t){var i=function(){var e="fix",t=$(window).scrollTop(),i=$("#J_img"),a=$("#J_proHeader").offset().top||140,s=i.offset().top,o=function(){var o=0;$(".J_notic").hasClass("hide")||(o=48),t>=s-64&&t>=a+o?(i.addClass(e).css({left:$(".pro-choose-main").offset().left}),t>=$("#J_proInfo").offset().top-640-o?(i.removeClass(e),i.css({marginTop:$(".pro-info").height()-560-o+"px"})):i.css({marginTop:0})):i.removeClass(e)};$(window).on("scroll.fix",function(){t=$(this).scrollTop(),o()}),setTimeout(function(){o()},1e3),$(window).on("resize.fix",function(){o()})};e.exports=i},function(e,t,i){i(10);var a="",s=function(){function e(e,t){var i=$(e),a=i.find(".slider").eq(t);a.hasClass("done")||a.attr("src",a.data("src")).addClass("done")}a&&a.destroySlider();var t=$("#J_sliderView");$(".J_imgload").addClass("hide"),$("#J_img").removeClass("hide"),a=t.slider({infiniteLoop:!0,hideControlOnEnd:!0,mode:"fade",auto:!0,autoHover:!0,onSliderLoad:function(i){e(t,i),$("#J_img").find(".slider").length<=1&&$("#J_img").find(".ui-controls").hide()},onSlideBefore:function(i,a,s){e(t,s)},startSlide:0})};e.exports=s},function(e,t,i){var a=i(13),s=i(12),o=function(e){var t=$.extend(a,e),i=t.buyModule,o=t._config,n=$(".J_setRemind"),r=n.data("type"),d=n.data("name"),l=n.data("tip");l=l?l:"取消到货通知";var c=function(){$(".J_setRemind").replaceWith('<a class="btn btn-gray btn-biglarge J_cancleRemind"  data-type="'+r+'" data-sign="disabled" href="javascript:void(0);"data-name="'+d+'">'+l+"</a>")};$("body").on("click",".J_setRemind",function(){i.checkProSelected(function(){s.ajax({url:t.orderSite+"/misc/onsaleRegister",data:{goods_id:o.id},callback:function(e){1===e.code?(c(),$("#J_setRemindModal").modal("show")):-2===e.code&&(window.location.href=t.loginUrl)}})})}),$("body").on("click",".J_cancleRemind",function(){i.checkProSelected(function(){s.ajax({url:t.orderSite+"/misc/onsaleCleanup",data:{goods_id:o.id},callback:function(e){1===e.code?i.setBtn():-2===e.code&&(window.location.href=t.loginUrl)}})})}),s.ajax({url:t.orderSite+"/misc/onsaleCheck",data:{goods_list:o.id},callback:function(e){1===e.code&&0!==e.data.length&&""!==e.data[o.id]&&c()}})};e.exports=o},function(e,t,i){var a=i(13),s=i(12),o=function(e){var t=e._config;return{config:$.extend(a,e),couponData:[],flowData:[],host:"//a.huodong.mi.com/",getCoupon:function(){var e=this,i=function(e){$("#J_couponModal").find(".list").addClass("hide").end().find(".result").removeClass("hide").find(".con").addClass("hide").end().find(e).removeClass("hide")};$("body").on("click",".J_getCoupon",function(){if(!e.config.isLogin)return void(window.location.href=e.config.hdloginUrl);var t=$(this).data("actcode"),a=$(this).data("drawcode");s.ajax({url:e.host+"activity/draw/draw/antiuid/123",data:{code:t,channel:"pc",activitytype:"draw",drawcode:a},callback:function(e){var t=e.code;return 0===t?void i(".succ"):20006===t||20007===t||20013===t||20014===t?void i(".over"):void i(".fail")}})}),$("body").on("click",".J_getCouponList",function(){return e.config.isLogin?void(t.coupon?e.getCouponList():($("#J_couponModal").modal("show"),t.coupon=!0)):void(window.location.href=e.config.hdloginUrl)}),$("body").on("click",".J_getCouponReturn",function(){e.getCouponList()})},getCouponList:function(e){var t=this;$(".J_saleWrap,.J_couponWrap").addClass("hide");var a=$("#J_couponModal"),o=$(".J_couponWrap"),n=i(18),r=this.config.acts_info;if(r){if(this.couponData=r.can_apply_coupons,this.host=r.coupon_draw_host,window.flowData=r.acts,!(window.flowData||this.couponData&&0!==t.couponData.length))return void $(".J_saleWrap").addClass("hide");if($(".J_saleWrap").removeClass("hide"),this.couponData&&0!==this.couponData.length){var d=0,l="",c="";for(var p in this.couponData)0===d&&(l=this.couponData[p].name),this.couponData[p].id=p,c+=n(this.couponData[p]),d++;d>1&&(l=l+"等"+d+"种优惠券"),o.removeClass("hide").find(".J_couponName").html(l),a.find(".list").removeClass("hide").end().find(".result").addClass("hide").end().find("ul").html(c).end().find(".no-coupon").remove(),"init"!==e&&a.modal("show")}else o.addClass("hide"),a.find(".list").removeClass("hide").append('<p class="no-coupon">优惠券已经被领光了</p>').end().find(".result").addClass("hide").end().find("ul").html("");r.sync_login&&0===s.proxy&&s.setProxy(function(){},r.sync_login)}},setFlow:function(e){var t=$(".J_flowWrap");if(window.flowData&&window.flowData[e]){var a=i(19);t.removeClass("hide").html(a(window.flowData[e])),$(".J_saleWrap").removeClass("hide")}else t.addClass("hide"),$(".J_couponWrap").hasClass("hide")&&$(".J_saleWrap").addClass("hide")},init:function(){this.getCouponList("init"),this.getCoupon()}}};e.exports=o},function(e,t){e.exports=function(e){function t(e,t){return(10>e?"0"+e:e)+t}function i(e){var i=new Date(1e3*parseInt(e));return Y=i.getFullYear()+"-",month=i.getMonth(),M=t(i.getMonth()+1,"-"),D=t(i.getDate(),"  "),h=t(i.getHours(),":"),m=t(i.getMinutes(),":"),s=t(i.getSeconds(),""),Y+M+D+h+m+s}var a='<li> <div class="coupon-price"> <sup>￥</sup>'+e.money+' </div> <div class="coupon-con"> <p class="coupon-txt">使用范围：'+e.range_desc+"</p> ";return a+=' <p class="coupon-time">'+i(e.event_start_time)+" 到 "+i(e.event_end_time)+' 领取</p> <a href="javascript:void(0);" class="J_getCoupon" data-actcode="'+e.event_act_code+'" data-drawcode="'+e.event_draw_code+'">立即领取</a> </div></li>'}},function(e,t){e.exports=function(e){var t="<ul> ";for(var i in e)t+=' <li> <span class="flow-tag">'+e[i].typeDesc+'</span> <span class="flow-name">'+e[i].title+"</span> </li> ";return t+="</ul>"}},function(e,t,i){var a=i(13),s=i(12),o=function(e){var t=e._config;return{item:4,curCount:1,totlePage:1,config:$.extend(a,e),setOrder:function(){var e=this,a=$("#J_orderModal"),o={goods_id:t.id,appointment_batch:t.subscribe.batch_key,activity_code:t.subscribe.activity_code};e.config.need_address&&(o.address_id=t.orderAddressId),s.ajax({url:e.config.orderSubmitUrl,data:o,callback:function(s){return-1===s.code?void(window.location.href=e.config.loginUrl):void(1===s.code?(a.modal("hide"),1===s.data.status&&($("#J_orderModalSucc").modal("show"),s.data.prize&&setTimeout(function(){$("#J_orderModalSucc").modal("hide");var e=i(21);$("#J_orderPrize").modal("show").find(".modal-body").html(e(s.data.prize))})),2===s.data.status&&MI.alert({msg:"已预约",isConfirm:!1}),$(".J_proBuyBtn").addClass("btn-disabled").html("已预约").removeClass("J_proBuyBtn"),t.orderData[t.id]=!0):a.find(".J_msg").html(s.msg))}})},orderAddress:function(){var e=this,i=$("#J_orderModal");$("body").on("click","#J_orderModal li",function(){t.orderAddressId=$(this).data("id"),$(this).addClass("active").siblings().removeClass("active"),i.find(".J_msg").html("")}),$("body").on("click",".J_orderSent",function(){return t.orderAddressId?void e.setOrder():void i.find(".J_msg").html("请选择一个预约地址")}),$("body").on("click",".J_next",function(){return e.curCount++,e.curCount>e.totlePage?void(e.curCount=e.totlePage):void e.formatAddress()}),$("body").on("click",".J_prev",function(){return e.curCount--,e.curCount<=0?void(e.curCount=1):void e.formatAddress()})},formatAddress:function(){var e={href:this.config.addAddressUrl,item:this.item,curCount:this.curCount,totlePage:this.totlePage,data:this.data};$("#J_orderModal").modal("show").find(".modal-body").html(this.tmp(e))},getAddresslist:function(){var e=this;s.ajax({url:e.config.addressListUrl,callback:function(t){if(1===t.code)e.data=t.data,e.totlePage=Math.ceil(e.data.length/e.item),e.formatAddress();else{if(-2===t.code)return void(location.href=e.config.loginUrl);MI.alert({msg:t.msg,isConfirm:!1})}}})},getCount:function(){s.ajax({url:this.config.orderCount,data:{goods_id_list:t.id,appointment_batch:t.subscribe.batch_key},callback:function(e){1===e.code&&e.data.count>t.subscribe.display_threshold&&$(".J_orderCount").removeClass("hide").html(e.data.count+"人 已预约")}})},init:function(){this.config.need_address?(this.orderAddress(),this.tmp=i(22),this.getAddresslist()):this.setOrder()}}};e.exports=o},function(e,t){e.exports=function(e){var t="";return e.prize_img?(t+='<div class="prize-bg"> <a class="close" data-dismiss="modal"></a> <h3>恭喜你！获得'+e.prize_name+'</h3> <img src="'+e.prize_img+'" alt=""> <p>'+e.prize_info+"</p> ",1==e.prize_type&&(t+=' <a href="'+MI.GLOBAL_CONFIG.orderSite+'/user/coupon/">查看我的奖励 &gt; </a> '),t+=" ",11==e.prize_type&&(t+=' <a href="'+MI.GLOBAL_CONFIG.orderSite+'/invite/list/">查看我的奖励 &gt; </a> '),t+=" ",18==e.prize_type&&(t+=' <a href="//redpack.pay.xiaomi.com/redPackage/wap/new/hongbao">查看我的奖励 &gt; </a> '),t+="</div>"):(t+='<div class="prize-mitu"> <a class="close" data-dismiss="modal"><i class="iconfont">&#xe602;</i></a> <img src="//i1.mifile.cn/f/i/17/static/mitu.png" alt=""> <h3>恭喜你！获得'+e.prize_name+"</h3> <p>"+e.prize_info+"</p> ",1==e.prize_type&&(t+=' <a href="'+MI.GLOBAL_CONFIG.orderSite+'/user/coupon/">查看我的奖励 &gt; </a> '),t+=" ",11==e.prize_type&&(t+=' <a href="'+MI.GLOBAL_CONFIG.orderSite+'/invite/list/">查看我的奖励 &gt; </a> '),t+=" ",18==e.prize_type&&(t+=' <a href="//redpack.pay.xiaomi.com/redPackage/wap/new/hongbao">查看我的奖励 &gt; </a> '),t+="</div>"),t}},function(e,t){e.exports=function(e){var t='<div class="modal-title"> 选择预约信息 ';if(e.data.length>0&&(t+=' <a href="'+e.href+'">+ 添加新地址</a> '),t+="</div>",0===e.data.length)t+=' <img src="http://i1.mifile.cn/f/i/17/static/no_address.jpg"> <a href="'+e.href+'" class="btn btn-primary btn-biglarge">添加新地址</a>';else{var i=e.data.slice((e.curCount-1)*e.item,e.data.length>e.item?e.curCount*e.item:e.data.length);t+='<ul class="clearfix"> ';var a=i;if(a)for(var s,o=-1,n=a.length-1;n>o;)s=a[o+=1],t+=' <li data-id="'+s.address_id+'"> <div class="address-title"> <span class="item">'+s.consignee+'</span> <span class="item">'+s.city.name+'</span> </div> <div class="address-desc">'+s.city.name+s.district.name+s.area.name+" </div> </li> ";t+="</ul>",e.data.length>e.item&&(t+='<div class="xm-controls xm-controls-small" '+e.data.length+'> <a class="control control-prev iconfont J_prev" href="javascript: void(0);">&#xe628;</a> <span>'+e.curCount+"</span> / "+e.totlePage+' <a class="control control-next iconfont J_next" href="javascript: void(0);">&#xe623;</a></div>'),t+='<a href="javascript:void(0);" class="btn btn-primary btn-biglarge J_orderSent">确定</a><p class="error J_msg"></p>'}return t}},function(e,t,i){var a=[],s=function(){if(0!==$("#J_proHeader").length){var e=i(24),t=$("#J_proHeader").find("h2").text();$("#J_proHeader").html(e(t));var s=function(){var e=$(window).scrollTop();for(var t in a)if(a.hasOwnProperty(t)){var i=a[t],s=i.top;e>s?i.callback(i,e):i.reverse&&i.reverse(i,e)}};$(window).on("scroll",function(){s()}),0===$(".J_miOneScroller").length&&$("html,body").animate({scrollTop:1===$("#J_proHeader").length?$("#J_proHeader").offset().top:140},1e3)}},o=function(){var e=140;1===$("#J_proHeader").length&&(e=$("#J_proHeader").offset().top+$("#J_proHeader").height());var t=e;a.push({top:t,callback:function(){$("#J_fixNarBar").addClass("nav_fix")},reverse:function(){$("#J_fixNarBar").removeClass("nav_fix")}})},n=function(e){if(s(),e){e.id=window.proBuy_id||e.product_id,e.target="buy",e.domain=MI.GLOBAL_CONFIG.itemSite,e.url="//"+window.location.host+window.location.pathname;var t=i(25);if($(".J_navSwitch").find(".con").html(t(e)),o(),e.qrcode_list){var a=$("#J_mpQrcode"),n=$("#J_mpQrcodeTmp");if(a.length>0&&n.length>0){var r=doT.template(n.html());a.html(r(e))}}}};e.exports=n},function(e,t){e.exports=function(e){var t='<div class="xm-product-box"> <div class="nav-bar" id="J_headNav"> <div class="container J_navSwitch"> <h2 class="J_proName">'+e+'</h2> <div class="con"></div> </div> </div></div><div class="xm-product-box nav-bar-hidden" id="J_fixNarBar"> <div class="nav-bar" > <div class="container J_navSwitch"> <h2 class="J_proName">'+e+'</h2> <div class="con"></div> </div> </div></div>';return t}},function(e,t){e.exports=function(e){var t="";if(e.left&&e.left.length>0){t+='<div class="left"> ';var i=e.left;if(i)for(var a,s=-1,o=i.length-1;o>s;){a=i[s+=1],t+=" ";var n=a.url.replace(/^http:\/\/|^https:\/\//g,"//");t+=' <span class="separator">|</span> ',n===e.url?t+=' <a  href="javascript:void(0);" class="cur" >'+a.title+"</a> ":(t+=' <a  href="'+n+'" ',a.is_new_page&&(t+='target="_blank"'),t+=">"+a.title+"</a> "),t+=" "}t+="</div>"}if(t+='<div class="right">',e.right&&e.right.length>0){t+=" ";var r=e.right;if(r)for(var a,s=-1,d=r.length-1;d>s;){a=r[s+=1],t+=" ";var n=a.url.replace(/^http:\/\/|^https:\/\//g,"//");t+=" ",n===e.url?t+=' <a  href="javascript:void(0);" class="cur" >'+a.title+"</a> ":(t+=' <a  href="'+n+'" ',a.is_new_page&&(t+='target="_blank"'),t+=">"+a.title+"</a> "),t+=' <span class="separator">|</span> '}}return e.id&&(t+=" ","buy"===e.target&&(t+=' <a href="'+e.domain+"/comment/"+e.id+'.html">用户评价</a> '),t+=" ","comment"===e.target&&(t+=' <a href="javascript:void(0);" class="cur">用户评价</a> <a href="'+e.domain+"/product/"+e.id+'.html" class="btn btn-small btn-primary" >立即购买</a> '),t+=" ","buy"!==e.target&&"comment"!==e.target&&(t+=' <a href="'+e.domain+"/comment/"+e.id+'.html" >用户评价</a> <a href="'+e.domain+"/product/"+e.id+'.html" class="btn btn-small btn-primary" >立即购买</a> ')),t+="</div>"}},function(e,t){e.exports=function(e){var t="<ul > ",i=0;if(t+=" ",""!==e.product){t+=" ";var a=parseFloat(e.product.price);t+=" ",e.seckillSale&&(t+=" ",a=parseFloat(e.product.seckill.seckill.seckill_price),t+=" "),t+=" <li>"+e.product.name+" ",parseFloat(e.product.market_price)>a&&(t+=" <del>"+parseFloat(e.product.market_price)+"元</del> "),t+=" <span>                 "+a+" 元 </span> </li> ",e.seckillSale?(t+=" ",i+=a,t+=" "):(t+=" ","booking"===e.type?(t+=" ",i+=parseFloat(e.bookPrice),t+=" "):(t+=" ",i+=a,t+=" "),t+=" "),t+="  "}t+=" ";for(var s in e.services){t+=" ";for(var o in e.services[s])t+=" <li>"+e.services[s][o].name+" ",parseFloat(e.services[s][o].oriprice)>parseFloat(e.services[s][o].price)&&(t+=" <del>  "+parseFloat(e.services[s][o].oriprice)+"元</del> "),t+=" <span>"+parseFloat(e.services[s][o].price)+"元</span> </li> ",i+=parseFloat(e.services[s][o].price),t+=" ";t+=" "}if(t+=" ",null!==e.mitvMember&&(t+=" <li>"+e.mitvMember.name+" <span>"+e.mitvMember.price+"</span> </li> ",i+=parseFloat(e.mitvMember.price),t+=" "),t+=" ",e.parts.length>0){t+=" ";var n=e.parts;if(n)for(var r,d=-1,l=n.length-1;l>d;)r=n[d+=1],t+=" <li>"+r.name+" <span>"+r.price+"</span> </li> ",i+=parseFloat(r.price),t+=" ";t+=" "}return t+=' <li class="totlePrice"> ',e.seckillSale?t+=" 闪购价 ":(t+=" ",t+="booking"===e.type?" 预付款 ":" 总计 ",t+=" "),t+=" ："+i+"元 ",e.product.shipment_text&&(t+=" <em>("+e.product.shipment_text+")</em> "),t+=" </li></ul>"}},function(e,t){e.exports=function(e){var t="",i=e;if(i)for(var a,s=-1,o=i.length-1;o>s;){a=i[s+=1];var n=a.service_info;if(n){t+='<div class="pro-choose list-choose list-choose-small hide J_service" data-index="'+s+'" data-multi="'+a.can_multi+'"> <div class="step-title"> 选择小米提供的'+a.type_name+' <a  href="'+a.type_url+'" target="_blank" >了解'+a.type_name+" &gt;</a> </div> <ul> ";var r=n;if(r)for(var d,l=-1,c=r.length-1;c>l;){if(d=r[l+=1],t+=" <li ",d.is_check&&(t+=' class="active" '),t+=' data-oriprice="'+d.service_market_price+'" ',t+=parseFloat(d.act_diff)>0&&""!=d.service_market_price?' data-price="'+d.act_price+'" ':' data-price="'+d.service_price+'" ',t+=' data-name="'+d.service_short_name+'" data-bargain_id="'+d.bargain_id+'" data-id="'+d.service_goods_id+'" data-source="'+d.source+'"> <i class="iconfont icon-checkbox" ><em>√</em></i> <img src="'+d.service_image+'?width=50&height=50" > <div> <span class="name"> '+d.service_short_name+" ",parseFloat(d.service_market_price)>parseFloat(d.service_price)&&(t+=" <em>省"+(parseFloat(d.service_market_price)-parseFloat(d.service_price))+"元</em> "),t+='  </span> <p class="desc">'+d.service_name+"</p> ",d.phone_accidentIns){t+=' <p class="agreement"> <i class="iconfont icon-checkbox J_read"><em>√</em></i> 我已阅读 ';var p=d.phone_accidentIns;if(p)for(var h,u=-1,g=p.length-1;g>u;)h=p[u+=1],t+=' <a href="'+h.url+'" target="_blank">'+h.desc,u!=d.phone_accidentIns.length-1&&(t+="<span>|</span>"),t+="</a> ";t+=" </p> "}t+=' <span class="price"> ',t+=parseFloat(d.act_diff)>0&&""!=d.service_market_price?" "+parseFloat(d.act_price)+"元 <del>"+parseFloat(d.service_market_price)+"元</del> ":" "+parseFloat(d.service_price)+"元 ",t+=" </span> </div> </li> "}t+=" </ul></div>"}}return t}},function(e,t){e.exports=function(e){var t="";if(e&&e.list){t+=" ";var i=e.list;if(i)for(var a,s=-1,o=i.length-1;o>s;)a=i[s+=1],t+=" ",t+=a.url&&""!=a.url?' <a href="'+a.url+'" target="_blank" title="'+a.desc+'"> ':' <a href="javascript:void(0);" title="'+a.desc+'"> ',t+=' <span class="',a.is_check&&(t+="support"),t+='"> ',t+=a.is_check?' <i class="iconfont" >&#xe618;</i> ':' <i class="iconfont">&#xe90c;</i> ',t+=" <em>"+a.title+"</em> </span> </a> "}return t}},function(e,t){e.exports=function(e){var t="";if(e.goods&&e.goods.action){t+=" ";var i=e.goods.action;t+=" ","bigtap"===i.type||"presales"===i.type||"booking"===i.type?(t+=" ",e.stock&&e.stock[e.goods.goods_id]?(t+=" ",i.isBigtap?(t+=" ",1===e.stock[e.goods.goods_id].hdstatus?(t+=" ",t+=i.check_login&&!e.isLogin?' <li> <a href="'+e.href+'" class="btn btn-primary btn-biglarge" data-type="'+i.type+'" data-isbigtap="'+i.isBigtap+'">登录后购买</a> </li> ':' <li class="countdown" data-name="'+i.name+'"> <a data-type="'+i.type+'" data-tip="'+i.next_sale_tip+'" class="btn btn-line-primary btn-biglarge J_setRemind" href="javascript:void(0);">到货通知</a> </li> ',t+=" "):(t+=" ",2===e.stock[e.goods.goods_id].hdstatus?(t+=" ",i.check_login&&!e.isLogin?t+=' <li> <a href="'+e.href+'" class="btn btn-primary btn-biglarge" data-type="'+i.type+'" data-isbigtap="'+i.isBigtap+'">登录后购买</a> </li> ':(t+=" ",t+="presales"===i.type?' <li> <a href="javascript:void(0);" class="btn btn-primary  btn-biglarge J_proBuyBtn" id="J_proAddcart" data-type="'+i.type+'" data-isbigtap="'+i.isBigtap+'" data-name="'+i.name+'">'+i.name+'</a> <div class="J_hasChange">全款预售，商品到货后按照预购顺序发货 <a href="#J_rulePresales" data-toggle=\'modal\'>了解详情</a></div> </li> ':' <li> <a href="javascript:void(0);" class="btn btn-primary btn-biglarge J_proBuyBtn" id="J_proAddcart" data-type="'+i.type+'" data-isbigtap="'+i.isBigtap+'" data-name="'+i.name+'">'+i.name+"</a> </li> ",t+=" "),t+=" "):t+=' <li> <a data-sign="disabled" data-type="'+i.type+'" data-tip="'+i.next_sale_tip+'" class="btn btn-disabled btn-biglarge " href="javascript:void(0);" data-isbigtap="'+i.isBigtap+'" data-name="'+i.name+'">暂时缺货</a> </li> ',t+=" "),t+=" "):(t+=" ",i.check_login&&!e.isLogin?t+=' <li> <a href="'+e.href+'" class="btn btn-primary btn-biglarge" data-isbigtap="'+i.isBigtap+'" data-type="'+i.type+'" data-name="'+i.name+'">登录后购买</a> </li> ':(t+=" ",t+="presales"===i.type?' <li> <a href="javascript:void(0);" class="btn btn-primary  btn-biglarge J_proBuyBtn" id="J_proAddcart" data-type="'+i.type+'" data-isbigtap="'+i.isBigtap+'" data-name="'+i.name+'">'+i.name+'</a> <div class="J_hasChange">全款预售，商品到货后按照预购顺序发货 <a href="#J_rulePresales" data-toggle=\'modal\'>了解详情</a></div> </li> ':' <li> <a href="javascript:void(0);" class="btn btn-primary btn-biglarge J_proBuyBtn" id="J_proAddcart" data-type="'+i.type+'" data-isbigtap="'+i.isBigtap+'" data-name="'+i.name+'">'+i.name+"</a> </li> ",t+=" "),t+=" "),t+=" "):(t+=" ",t+=i.isBigtap?' <li> <a  data-sign="disabled" data-type="'+i.type+'" data-tip="'+i.next_sale_tip+'" class="btn btn-disabled btn-biglarge" href="javascript:void(0);" data-isbigtap="'+i.isBigtap+'" data-name="'+i.name+'" >暂时缺货</a> </li> ':' <li> <a  data-sign="disabled" data-type="'+i.type+'" data-tip="'+i.next_sale_tip+'" class="btn btn-line-primary btn-biglarge J_setRemind" href="javascript:void(0);" data-isbigtap="'+i.isBigtap+'" data-name="'+i.name+'" >到货通知</a> </li> ',t+=" "),t+=" "):(t+=" ","subscribe"===i.type||"reserve"===i.type?(t+=" ",i.check_login&&!e.isLogin?t+=' <li> <a href="'+e.href+'" class="btn btn-primary btn-biglarge" data-isbigtap="'+i.isBigtap+'">登录后预约</a> </li> ':(t+=" ",e.isAllGoodsBooking?t+=' <li> <a href="javascript:void(0);" class="btn btn-disabled btn-biglarge" data-type="'+i.type+'" data-name="立即预约">立即预约</a> </li> ':(t+=" ",t+=i.has_reserved?' <li> <a href="javascript:void(0);" class="btn btn-disabled btn-biglarge" >已预约</a> </li> ':' <li> <a href="javascript:void(0);" class="btn btn-primary btn-biglarge J_proBuyBtn" data-type="'+i.type+'" data-name="'+i.name+'">'+i.name+"</a> </li> ",t+=" "),t+=" "),t+=" "):(t+=" ","common"===i.type||"glass"===i.type?(t+=" ",e.stock?(t+=" ",t+=e.stock[e.goods.goods_id]?' <li> <a href="javascript:void(0);" class="btn btn-primary btn-biglarge J_proBuyBtn" data-type="'+i.type+'" data-name="'+i.name+'">'+i.name+"</a> </li> ":' <li> <a data-type="'+i.type+'" data-sign="disabled" data-tip="'+i.next_sale_tip+'" class="btn btn-line-primary btn-biglarge J_setRemind disabled" href="javascript:void(0);" data-name="'+i.name+'">到货通知</a> </li> ',t+=" "):t+=' <li> <a data-type="'+i.type+'" data-sign="disabled" data-tip="'+i.next_sale_tip+'" class="btn btn-line-primary btn-biglarge J_setRemind disabled" href="javascript:void(0);" data-name="'+i.name+'">到货通知</a> </li> ',t+=" "):(t+=" <li> ",t+=i.path?' <a href="'+i.path+'" target="_blank" data-type="'+i.type+'" data-sign="disabled" class="btn btn-primary btn-biglarge" data-name="'+i.name+'">'+i.name+"</a> ":' <a href="javascript:void(0);" data-type="'+i.type+'" data-sign="disabled" class="btn btn-gray btn-biglarge btn-disabled" data-name="'+i.name+'">'+i.name+"</a> ",t+=" </li> "),t+=" "),t+=" ")}else t+='<li> <a data-sign="disabled" data-tip="'+i.next_sale_tip+'" class="btn btn-line-primary btn-biglarge J_setRemind" href="javascript:void(0);">到货通知</a> </li>';return t+="<li> ",t+=e.isLogin?' <a href="javascript:void(0);" class="btn-gray btn-like btn-biglarge" id="J_like"> <i class="iconfont default">&#xe62d;</i> <i class="iconfont red">&#xe62e;<i class="iconfont red J_redCopy">&#xe62e;</i></i> 喜欢 </a> ':' <a href="'+e.href+'" class="btn-gray btn-like btn-biglarge" > <i class="iconfont default">&#xe62d;</i>喜欢 </a> ',t+=" </li>"}},function(e,t){e.exports=function(e){var t='<div class="infor-con"> ',i=e.tab_content;if(i)for(var a,s=-1,o=i.length-1;o>s;){if(a=i[s+=1],t+=' <div class="section"> <div class="container"> ',"plain_view"===a.view_type&&a.plain_view.img&&(t+=" ",a.plain_view.title&&(t+=" <h3>"+a.plain_view.title+" ",a.plain_view.link_title&&(t+=' <a href="'+a.plain_view.link_url+'" target="_blank">'+a.plain_view.link_title+' <i class="iconfont">&#xe624;</i></a> '),t+=" </h3> "),t+=' <div class="con"><img data-src="'+a.plain_view.img+'" class="slider"></div> '),t+=" ","text_view"===a.view_type&&(t+=" ",a.text_view.title&&(t+=" <h3>"+a.text_view.title+" ",a.text_view.link_title&&(t+=' <a href="'+a.text_view.link_url+'" target="_blank">'+a.text_view.link_title+' <i class="iconfont">&#xe624;</i></a> '),t+=" </h3> "),t+=" ",a.text_view.des&&(t+=' <div class="con con-text "><div class="J_markdown" data-desc="'+a.text_view.desc+'"></div></div> '),t+=" "),t+=" ","gallery_view"===a.view_type){t+=' <div class="con"> <div class="imgbox J_imgBox"> ';var n=a.plain_view;if(n)for(var r,s=-1,d=n.length-1;d>s;)r=n[s+=1],t+=' <img data-src="'+r+'" class="slider"> ';t+=" </div> </div> "}t+=" </div> </div> "}return t+="</div>"}}]);